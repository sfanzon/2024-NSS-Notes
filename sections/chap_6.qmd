::: {.content-hidden}
$
{{< include macros.tex >}}
$
:::





# Sequences in $\mathbb{R}$



A sequence is an infinite list of real numbers. For example, the following are sequences:


- $(1,2,3,4, \ldots)$

- $(-1,1,-1,1, \ldots)$

- $\left(1, \frac{1}{2}, \frac{1}{3}, \frac{1}{4}, \frac{1}{5}, \ldots\right)$


::: Remark

- The order of elements in a sequence matters. 

> For example
>$$
>(1,2,3,4,5,6, \ldots) \neq(2,1,4,3,6,5, \ldots)
>$$

- A sequence is not a set. 

> For example 
>$$
>\{-1,1,-1,1,-1,1, \ldots\}=\{-1,1\}
>$$
>but we cannot make a similar statement for the sequence 
>$$
>(-1,1,-1,1,-1,1, \ldots) \,.
>$$

- The above notation is ambiguous.

> For example the sequence 
>$$
>(1,2,3,4, \ldots)
>$$
can continue as
>
>$$
>(1,2,3,4,1,2,3,4,1,2,3,4, \ldots) \,.
>$$

- In the sequence 
$$
\left(1, \frac{1}{2}, \frac{1}{3}, \frac{1}{4}, \frac{1}{5}, \ldots\right)
$$
the elements get smaller and smaller, and closer and closer to $0$. We say that this sequence converges to $0$, or has $0$ as a limit. 


:::


We would like to make the notions of sequence and convergence more precise.


## Definition of sequence


We start with the definition of sequence of Real numbers.


::: Definition 
### Sequence of Real numbers

A sequence $a$ in $\R$ is a function
$$
a \colon \N \to \R \,.
$$
For $n \in \N$, we denote the $n$-th element of the sequence $a$ by 
$$
a_{n}=a(n)
$$ 
and write the sequence as 
$$
\left(a_{n}\right)_{n \in \N} \,.
$$
:::


::: Notation

We will sometimes omit the subscript $n \in \N$ and simply write 
$$
\left(a_{n}\right) \,.
$$ 
In certain situations, we will also write
$$
\left(a_{n}\right)_{n=1}^{\infty} \,.
$$


:::




::: Example 

- In general $\left(a_{n}\right)_{n \in \N}$ is the sequence 
$$
\left(a_{1}, a_{2}, a_{3}, \ldots\right)\,.
$$

- Consider the function 
$$
a \colon \N \to \N \, , \quad  n \mapsto 2 n \,.
$$
This is also a sequence of real numbers. It can be written as 
$$
(2 n)_{n \in \N}
$$
and it represents the sequence of even numbers 
$$
(2,4,6,8,10, \ldots) \,.
$$

- Let 
$$
a_{n}=(-1)^{n}
$$
Then $\left(a_{n}\right)$ is the sequence 
$$
(-1,1,-1,1,-1,1, \ldots) \,.
$$

- $\left(\frac{1}{n}\right)_{n \in \N}$ is the sequence 
$$
\left(1, \frac{1}{2}, \frac{1}{4}, \frac{1}{5}, \ldots\right) \,.
$$


:::



## Convergent sequences


We have notice that the sequence $\left(\frac{1}{n}\right)_{n \in \N}$ gets close to $0$ as $n$ gets large. We would like to say that $a_{n}$ converges to $0$ as $n$ tends to infinity.

To make this precise, we first have to say what it means for two numbers to be *close*. For this we use the notion of absolute value, and say that:

- $x$ and $y$ are close if $|x-y|$ is small. 
- $|x-y|$ is called the distance between $x$ and $y$
- For $x$ to be close to $0$, we need that $|x-0|=|x|$ is small.

Saying that $|x|$ is *small* is not very precise. Let us now give the formal definition of convergent sequence.

::: Definition 
### Convergent sequence  {#definition-convergent-sequence}

We say that a sequence $\left(a_{n}\right)_{n \in \N}$ in $\mathbb{R}$ **converges** to $a \in \mathbb{R}$, or equivalently has limit $a$, denoted by
$$
\lim_{n \rightarrow \infty} a_{n}=a 
$$
if for all $\e \in \mathbb{R}, \e>0$, there exists $N \in \N$ such that for all $n \in \N, n \geq N$ it holds that 
$$
\left|a_{n}-a\right| < \e \,.
$$
Using quantifiers, we can write this as
$$
\forall \, \e>0 , \, \exists \, N \in \N \st \forall \, n \geq N \,, \,\left|a_{n}-a\right| < \e \,.
$$

If there exists $a \in \R$ such that $\lim_{n \rightarrow \infty} a_{n}=a$, then we say that the sequence $\left(a_{n}\right)_{n \in \N}$ is **convergent**.

:::


::: Notation

We will often write
$$
a_n \to a
$$
in place of
$$
\lim_{n \rightarrow \infty} a_{n}=a \,.
$$

:::


::: Remark

- Informally, Definition \ref{definition-convergent-sequence} says that, no matter how small we choose $\e$ (as long as it is strictly positive), we always have that $a_{n}$ has a distance to $a$ of less than or equal to $\e$ from a certain point onwards (i.e., from $N$ onward). The sequence $\left(a_{n}\right)$ may fluctuate wildly in the beginning, but from $N$ onward it should stay within a distance of $\e$ of $a$.

- In general $N$ depends on $\e$. If $\e$ is chosen smaller, we might have to take $N$ larger: this means we need to wait longer before the sequence stays within a distance $\e$ from $a$.

:::


We now prove that the sequence
$$
a_n = \frac1n
$$
converges to $0$, according to Definition \ref{definition-convergent-sequence}.

::: {.Theorem #theorem-one-over-n}

The sequence $\left(\frac{1}{n}\right)_{n \in \N}$ converges to $0$ , i.e.,

$$
\lim_{n \rightarrow \infty} \frac{1}{n}=0 \,.
$$

:::

We give two proofs of the above theorem:

- Long proof, with all the details.
- Short proof, with less details, but still acceptable. 

::: Proof 
### Proof of Theorem \ref{theorem-one-over-n} (Long version)

We have to show that

$$
\lim _{n \rightarrow \infty} \frac{1}{n}=0,
$$

which by definition is equivalent to showing that

$$
\forall \, \e>0 \,, \, \exists \, N \in \N \st  \forall  \, n \geq N \,, \, \left|\frac{1}{n}-0\right| < \e \,.
$${#eq-one-over-n}

Let $\e \in \mathbb{R}$ with $\e>0$. Choose $N \in \N$ such that 
$$
N > \frac{1}{\e}\,.
$$
Such natural number $N$ exists thanks to the Archimedean property. The above implies
$$
\frac{1}{N} < \e \,,
$${#eq-one-over-n-1}
Let $n \in \N$ with $n \geq N$. By (@eq-one-over-n-1) we have
$$
\frac{1}{n} \leq \frac{1}{N} < \e \,.
$$
From this we deduce
$$
\left|\frac{1}{n}-0\right|=\frac{1}{n} \leq \frac{1}{N} < \e
$$

Since $n \in \N, n \geq N$ was arbitrary, we have proven that 
$$
\left|\frac{1}{n}-0\right| < \e \,, \quad \forall \, n \geq N \,.
$${#eq-one-over-n-2}
Condition (@eq-one-over-n-2) holds for all $\e>0$, for the choice of $N \in \N$ such that
$$
N > \frac{1}{\e} \,.
$$
We have hence shown (@eq-one-over-n), and the proof is concluded.

:::

As the above proof is quite long and includes lots of details, it is acceptable to shorten it. For example:

- We skip some intermediate steps.
- We do not mention the Archimedean property.
- We leave out the conclusion when it is obvious that the statement has been proven. 




::: Proof 
### Proof of Theorem \ref{theorem-one-over-n} (Short version)

We have to show that

$$
\forall \, \e>0 \,, \, \exists \, N \in \N \st  \forall  \, n \geq N \,, \, \left|\frac{1}{n}-0\right| < \e \,.
$$

Let $\e>0$. Choose $N \in \N$ such that 
$$
N > \frac{1}{\e}\,.
$$
Let $n \geq N$. Then
$$
\left|\frac{1}{n}-0\right|=\frac{1}{n} \leq \frac{1}{N} < \e \,.
$$

:::


In Theorem \ref{theorem-one-over-n} we showed that 
$$
\lim_{n \to \infty} \, \frac{1}{n} = 0 \,.
$$
We can generalise this statement to prove that 
$$
\lim_{n \to \infty} \, \frac{1}{n^{p}} = 0
$$
for any $p>0$ fixed.


::: {.Theorem  #theorem-one-over-np}
For all $p>0$, the sequence $\left(\frac{1}{n^{p}}\right)_{n \in \N}$ converges to $0$ , i.e.,

$$
\lim _{n \rightarrow \infty} \frac{1}{n^{p}}=0
$$
:::

::: Proof

Let $p>0$. We have to show that
$$
\forall \e>0 \,, \, \exists \, N \in \N \st  \forall \, n \geq N \,, \, \left|\frac{1}{n^{p}}-0\right| < \e \,.
$$
Let $\e>0$. Choose $N \in \N$ such that 
$$
N > \frac{1}{\e^{1 / p}} \,.
$${#eq-theorem-one-over-np-1}
Let $n \geq N$. Since $p>0$, we have $n^{p} \geq N^{p}$, which implies 
$$
\frac{1}{n^p} \leq \frac{1}{N^p} \,.
$$
By (@eq-theorem-one-over-np-1) we deduce
$$
\frac{1}{N^p} < \e \,.
$$
Then
$$
\left|\frac{1}{n^{p}}-0\right|=\frac{1}{n^{p}} \leq \frac{1}{N^{p}} < \e \,.
$$

:::

::: Question
Why did we choose $N \in \N$ such that
$$
N > \frac{1}{\e^p}
$$
in the above proof?
:::

The answer is: because it works. Finding a number $N$ that makes the proof work requires some *rough work*: Specifically, such rough work consists in finding $N \in \N$ such that the inequality
$$
|a_N - a | < \e 
$$
is satisfied. 


::: Important 

Any *rough work* required to prove convergence must be shown before the formal proof (in assignments). 

:::




::: Example 

Prove that, as $n \rightarrow \infty$,

$$
\frac{n}{2n+3} \to \frac{1}{2} \,.
$$

*Part 1. Rough Work.*

Let $\e>0$. We want to find $N \in \N$ such that
$$
\left|\frac{n}{2n+3}-\frac{1}{2}\right| < \e \,, \quad \forall \, n \geq N \,.
$$
To this end, we compute:
\begin{align*}
\left|\frac{n}{2 n+3}-\frac{1}{2}\right| & 
=\left|\frac{2n -(2n + 3)}{2(2n +3)}\right| \\
& =\left|\frac{- 3}{4n + 6}\right| \\
& = \frac{3}{4n + 6} \,.
\end{align*}
Therefore 
\begin{align*}
\left|\frac{n}{2n+3}-\frac{1}{2}\right| < \e
\quad \iff &  \quad
\frac{3}{4n + 6} < \e \\
\quad \iff &  \quad
\frac{4n + 6}{3} > \frac{1}{\e} \\
\quad \iff &  \quad
4n + 6 > \frac{3}{\e} \\
\quad \iff &  \quad
4n  > \frac{3}{\e} - 6 \\
\quad \iff &  \quad
n  > \frac{3}{4\e} - \frac{6}{4} \,.
\end{align*}
Looking at the above equivalences, it is clear that $N \in \N$ has to be chosen so that
$$
N  > \frac{3}{4\e} - \frac{6}{4} \,.
$$


*Part 2. Formal Proof.* We have to show that
$$
\forall \e>0 \,, \, \exists \, N \in \N \st  \forall \, n \geq N \,, \, \left|\frac{n}{2n+3}-\frac{1}{2}\right| < \e  \,.
$$
Let $\e>0$. Choose $N \in \N$ such that
$$
N > \frac{3}{4\e} - \frac{6}{4}   \,.
$${#eq-example-limit-1}
By the rough work shown above, inequality (@eq-example-limit-1) is equivalent to 
$$
 \frac{3}{4N + 6} < \e \,.
$$
Let $n \geq N$. Then
\begin{align*}
\left|\frac{n}{2n+3}-\frac{1}{2}\right| 
& = \left|\frac{- 3 }{2(2 n+3)}\right| \\
& = \frac{3}{4 n+ 6 } \\
& \leq \frac{3}{4 N+ 6 } \\
& < \e \,,
\end{align*}
where in the third line we used that $n \geq N$.

:::


We conclude by showing that constant sequences always converge.

::: {.Theorem #theorem-constant-sequence}

Let $c \in \R$ and define the constant sequence
$$
a_n := c \,, \quad \forall \, n \in \N \,.
$$
We have that 
$$
\lim_{n \to \infty} \, a_n = c \,.
$$

:::

::: Proof

We have to prove that
$$
\forall \e>0 \,, \, \exists \, N \in \N \st  \forall \, n \geq N \,, \, \left|a_n - c \right| < \e  \,.
$${#eq-constant-sequence}
Let $\e>0$. We have
$$
\left|a_n - c \right| = \left|c - c \right| = 0 < \e \,, \quad \forall \, n \in \N \,.
$$
Therefore we can choose $N=1$ and (@eq-constant-sequence) is satisfied. 
:::




## Divergent sequences


The opposite of convergent sequences are divergent sequences.

::: Definition
### Divergent sequence

We say that a sequence $\left(a_{n}\right)_{n \in \N}$ in $\R$ is **divergent** if it is not convergent.

:::



::: Remark

Proving that a sequence $(a_n)$ is divergent is more complicated than showing it is convergent: To show that $(a_n)$ is divergent, we need to show that 
$(a_n)$ cannot converge to $a$ for any $a \in \R$.

In other words, we have to show that there does not exist an $a \in \mathbb{R}$ such that 
$$
\lim _{n \rightarrow \infty} \, a_n = a  \,.
$$
Using quantifiers, this means
$$
\nexists \, a \in \R \st \forall \, \e>0 \,, \, 
\exists \, N \in \N \st \forall \, n \geq N \,, \,
\left|a_{n}-a\right| < \e \,.
$$
The above is equivalent to showing that
$$
\forall \, a \in \R \,, \, \exists \, \e > 0 \st  \forall \, N \in \N \,, \, \exists \, n \geq N \st \left|a_{n}-a\right| \geq \e \,.
$$

:::



::: {.Theorem #theorem-1-minus-n}
Let $\left(a_{n}\right)$ be the sequence defined by
$$
a_{n}=(-1)^{n} \,.
$$
Then $\left(a_{n}\right)$ does not converge. 

:::

::: Proof

To prove that $\left(a_{n}\right)$ does not converge, we have to show that 
$$
\forall \, a \in \R \,, \, \exists \, \e > 0 \st  \forall \, N \in \N \,, \, \exists \, n \geq N \st \left|a_{n}-a\right| \geq \e \,.
$$
Let $a \in \R$. Choose 
$$
\e=\frac{1}{2} \,.
$$ 
Let $N \in \N$. We distinguish two cases:

- $a \geq 0$: Choose $n=2 N+1$. Note that $n \geq N$. Then
\begin{align*}
\left|a_{n}-a\right| & = \left|a_{2 N+1}-a\right| \\
& = \left|(-1)^{2 N+1}-a\right| \\
& =|-1-a| \\
& =1+a \\
& \geq 1 \\
& > \frac{1}{2} = \e \,,
\end{align*}
where we used that $a \geq 0$, and therefore 
$$
|-1-a|=1+a \geq 1 \,.
$$

- $a<0$: Choose $n=2 N$. Note that $n \geq N$. Then
\begin{align*}
\left|a_{n}-a\right| & = \left|a_{2 N}-a\right| \\
& =\left|(-1)^{2 N}-a\right| \\ 
& = |1-a| \\
& = 1-a \\
& > 1 \\
& > \frac{1}{2} = \e \,,
\end{align*}
where we used that $a < 0$, and therefore 
$$
|1-a|=1-a > 1 \,.
$$


:::



## Uniqueness of limit


In Definition \ref{definition-convergent-sequence} of convergence, we used the notation 
$$
\lim_{n \rightarrow \infty} a_{n}=a \,.
$$ 
The above notation makes sense only if the limit is unique, that is, if we do not have that  
$$
\lim_{n \rightarrow \infty} a_{n} = b \,,
$$ 
for some 
$$
a \neq b \,.
$$
In the next theorem we will show that the limit is unique, if it exists.

::: Theorem 
### Uniqueness of limit  {#theorem-uniqueness-limit}

Let $\left(a_{n}\right)_{n \in \N}$ be a sequence. Suppose that 
$$
\lim_{n \rightarrow \infty} a_{n} = a \,, \quad 
\lim_{n \rightarrow \infty} a_{n} = b \,.
$$
Then $a=b$.
:::


::: Proof

Assume that, 
$$
\lim_{n \rightarrow \infty} a_{n} = a \,, \quad 
\lim_{n \rightarrow \infty} a_{n} = b \,.
$$
Suppose by contradiction that
$$
a \neq b \,.
$$
Choose 
$$
\e := \frac{1}{2} \, |a-b| \,.
$$
Therefore $\e>0$, since $|a-b|>0$. By the convergence $a_{n} \rightarrow a$,
$$
\exists \, N_1 \in \N \st \forall \, n \geq N_1 \,, \, 
\left|a_{n}-a\right| < \e \,.
$$
By the convergence $a_{n} \rightarrow b$,
$$
\exists \, N_2 \in \N \st \forall \, n \geq N_2 \,, \, 
\left|a_{n} - b \right| < \e \,.
$$
Define
$$
N := \max \{ N_1, N_2 \} \,.
$$
Choose an $n \in \N$ such that $n \geq N$. In particular
$$
n \geq N_1 \,, \quad n \geq N_2 \,.
$$
Then
\begin{align*}
2 \e & = |a-b| \\
& = \left|a-a_{n}+a_{n}-b\right| \\
& \leq\left|a-a_{n}\right|+\left|a_{n}-b\right| \\
& < \e + \e \\
& = 2 \e \,,
\end{align*}
where we used the triangle inequality in the first inequality.
Hence $2 \e < 2 \e$, which gives a contradiction.

:::


::: Example 

Prove that

$$
\lim _{n \rightarrow \infty} \frac{n^{2}-1}{2 n^{2}-3}=\frac{1}{2}
$$

According to Theorem \ref{theorem-uniqueness-limit}, it suffices to show that the sequence 
$$
\left(\frac{n^{2}-1}{2 n^{2}-3}\right)_{n \in \N}
$$ 
converges to $\frac{1}{2}$, since then $\frac{1}{2}$ can be the only limit.


*Part 1. Rough Work.*

Let $\e>0$. We want to find $N \in \N$ such that
$$
\left|\frac{n^{2}-1}{2 n^{2}-3} - \frac{1}{2}\right| < \e \,, \quad \forall \, n \geq N \,.
$$
To this end, we compute:
\begin{align*}
\left|\frac{n^{2}-1}{2 n^{2}-3}-\frac{1}{2}\right| 
& =\left|\frac{2\left(n^{2}-1\right)-\left(2 n^{2}-3\right)}{2\left(2 n^{2}-3\right)}\right| \\
& =\left|\frac{1}{4 n^{2}-6}\right| \\
& =\frac{1}{4 n^{2}-6} \\
& =\frac{1}{3 n^{2}+n^{2}-6} \\
& \leq \frac{1}{3 n^{2}} 
\end{align*}
which holds if $n \geq 3$, since in this case $n^2 - 6 \geq 0$.
Therefore 
\begin{align*}
\left|\frac{n^{2}-1}{2 n^{2}-3}-\frac{1}{2}\right|  < \e
\quad \impliedby &  \quad
\frac{1}{3n^2} < \e \\
\quad \iff &  \quad
3n^2  > \frac{1}{\e} \\
\quad \iff &  \quad
n^2  > \frac{1}{3\e} \\
\quad \iff &  \quad
n  > \frac{1}{\sqrt{3\e}} \,.
\end{align*}
Looking at the above implications, it is clear that $N \in \N$ has to be chosen so that
$$
N  > \frac{1}{\sqrt{3\e}} \,.
$$
Moreover we need to recall that $N$ has to satisfy 
$$
N \geq 3
$$ 
for the estimates to hold.


*Part 2. Formal Proof.* We have to show that
$$
\forall \e>0 \,, \, \exists \, N \in \N \st  \forall \, n \geq N \,, \, \left|\frac{n^{2}-1}{2 n^{2}-3}-\frac{1}{2}\right| < \e  \,.
$$
Let $\e>0$. Choose $N \in \N$ such that
$$
N > \max \left\{ \frac{1}{\sqrt{3\e}}, 3 \right\}   \,.
$$
Let $n \geq N$. Then
\begin{align*}
\left|\frac{n^{2}-1}{2 n^{2}-3}-\frac{1}{2}\right| 
& =\frac{1}{4 n^{2}-6} \\
& =\frac{1}{3 n^{2}+n^{2}-6} \\
& \leq \frac{1}{3 n^{2}} \\
& \leq \frac{1}{3 N^{2}} \\
& < \e \,,
\end{align*}
where we used that 
$$
n \geq N \geq 3 
$$ 
which implies 
$$
n^2 - 6 \geq 0\,,
$$
in the third line. The last inequality holds, since it is equivalent 
to 
$$
N > \frac{1}{\sqrt{3 \e}} \,.
$$

:::




## Bounded sequences


An important property of sequences is boundedness. 


::: Definition 
### Bounded sequence  {#definition-bounded-sequence}

A sequence $\left(a_{n}\right)_{n \in \N}$ is called **bounded** if there exists a constant $M \in \R$, with $M>0$, such that
$$
\left|a_{n}\right| \leq M \,, \quad \forall \, n \in \N \,.
$$

:::

Definition \ref{definition-bounded-sequence} says that a sequence is bounded, if we can find some constant $M>0$ (possibly very large), such that for all elements of the sequence it holds that 
$$
\left|a_{n}\right| \leq M \,,
$$
or equivalently, that 
$$
-M \leq a_{n} \leq M \,.
$$


We now show that any sequence that converges is also bounded

::: {.Theorem  #theorem-convergent-bounded}

If a sequence $\left(a_{n}\right)_{n \in \mathbb{N}}$ converges, then the sequence is bounded.

:::


::: Proof 

Suppose the sequence $\left(a_{n}\right)_{n \in \mathbb{N}}$ converges and let
$$
a: = \lim_{n \rightarrow \infty} a_{n}
$$
By definition of convergence we have that
$$
\forall \, \e >0 \,, \, \exists N \in \N  \st  \forall \, n \geq N \,, \, \left|a_{n}-a \right| < \e \,.
$$
In particular, we can choose
$$
\e = 1
$$ 
and let $N \in \N$ be that value such that
$$
\left|a_{n}-a \right| < 1 \,, \quad \forall \, n \geq N \,.
$$
If $n \geq N$ we have, by the triangle inequality,
\begin{align*}
\left|a_{n}\right| & = \left|a_{n}-a+a\right| \\
                   & \leq \left|a_{n}-a\right|+|a| \\
                   & < 1+|a| \,.
\end{align*}
Set
$$
M:=\max \left\{\left|a_{1}\right|,\left|a_{2}\right|, \ldots,\left|a_{N-1}\right|, 1+|a|\right\} \,.
$$
Note that such maximum exists, being the set finite. Then 
$$
\left|a_{n}\right| \leq M \,, \quad \forall \, n \in \N \,,
$$
showing that $(a_n)$ is bounded.

:::


The choice of $M$ in the above proof says that the sequence can behave wildly for a finite number of terms. After that, it will stay close to the value of the limit, if the latter exists.

::: Example

In Theorem \ref{theorem-one-over-n} we have shown that 
$$
\lim_{n \to \infty} \,  \frac{1}{n} = 0 
$$
Hence, it follows from Theorem \ref{theorem-convergent-bounded} that the sequence $(1/n)$ is bounded.

Indeed, we have that
$$
\left|\frac{1}{n}\right|=\frac{1}{n} \leq 1 \,, \quad \forall \, n \in \N \,,
$$
since $n \geq 1$ for all $n \in \N$.

:::


::: Warning

The converse of Theorem \ref{theorem-convergent-bounded} does not hold: There exist sequences $(a_n)$ which are bounded, but not convergent.

:::


::: Example

Define the sequence
$$
a_n = (-1)^n \,.
$$
We have proven in Theorem \ref{theorem-1-minus-n} that $(a_n)$ is not convergent. However
$(a_n)$ is bounded, with $M=1$, since
$$
|a_n| = |(-1)^n| = 1 = M  \,, \quad \forall \, n \in \N \,.
$$

:::



Taking the contrapositive of the statement in Theorem \ref{theorem-convergent-bounded} we get the following corollary:


::: {.Corollary   #corollary-convergent-bounded}

If a sequence $\left(a_{n}\right)_{n \in \mathbb{N}}$ is not bounded, then the sequence does not converge.

:::


::: Remark

For a sequence $(a_n)$ to be unbounded, it means that
$$
\forall \, M > 0 \,, \,\,  \exists \, n \in \N \st \left|a_{n}\right| > M \,.
$$
The above is saying that no real number $M>0$ can be a bound for $|a_n|$, since there is always an index $n \in \N$ such that 
$$
|a_n| > M \,.
$$

:::


We can use Corollary \ref{corollary-convergent-bounded} to show that certain sequences do not converge.


::: Theorem 

For all $p>0$, the sequence $\left(n^{p}\right)_{n \in \mathbb{N}}$ does not converge.

:::


::: Proof
Let $p>0$. We prove that the sequence $\left(n^{p}\right)_{n \in \mathbb{N}}$ is unbounded, that is, 
$$
\forall \, M > 0 \,, \,\,  \exists \, n \in \N \st \left|a_{n}\right| > M \,.
$$
To this end, let $M > 0$. Choose $n \in \N$ such that 
$$
n > M^{1/p} \,.
$$
Then
$$
a_n = n^{p}>\left(M^{1/p}\right)^{p}=M \,.
$$
This proves that the sequence $(n^p)$ is unbounded. Hence $(n^p)$ cannot converge, by Corollary \ref{corollary-convergent-bounded}.

:::



::: Theorem

The sequence $(\log n)_{n \in \mathbb{N}}$ does not converge.

:::


::: Proof 

Let us show that $(\log n)_{n \in \mathbb{N}}$ is unbounded, that is, 
$$
\forall \, M > 0  \,, \,\,  \exists \, n \in \N \st \left|a_{n}\right| > M \,.
$$
To this end let $M > 0$. Choose $n \in \N$ such that 
$$
n \geq e^{M+1} \,.
$$
Then
$$
|a_n| = |\log n| \geq \left|   \log e^{M+1}   \right| = M + 1 > M \,.
$$
This proves that the sequence $(\log n)$ is unbounded. Hence $(\log n)$ cannot converge, by Corollary \ref{corollary-convergent-bounded}.

:::




## Algebra of limits

Proving convergence using Definition \ref{definition-convergent-sequence} can be a tedious task. In this section we discuss how to prove convergence, starting from known convergence results.


::: Theorem 
### Algebra of limits {#theorem-algebra-limits} 

Let $\left(a_{n}\right)_{n \in \mathbb{N}}$ and $\left(b_{n}\right)_{n \in \mathbb{N}}$ be sequences in $\mathbb{R}$. Suppose that
$$
\lim_{n \rightarrow \infty} a_{n}=a \,, \quad  \lim_{n \rightarrow \infty} b_{n}=b \,,
$$
for some $a,b \in \R$. Then,

1. Limit of sum is the sum of limits:
$$
\lim_{n \rightarrow \infty}\left(a_{n} \pm b_{n}\right)=a \pm b
$$

2. Limit of product is the product of limits: 
$$
\lim _{n \rightarrow \infty}\left(a_{n}  b_{n}\right) = a  b 
$$

3. If $b_{n} \neq 0$ for all $n \in \mathbb{N}$ and $b \neq 0$, then 
$$
\lim_{n \rightarrow \infty} \left(\frac{a_{n}}{b_{n}}\right)=\frac{a}{b} 
$$

:::




::: Proof 


 Let $\left(a_{n}\right)_{n \in \mathbb{N}}$ and $\left(b_{n}\right)_{n \in \mathbb{N}}$ be sequences in $\mathbb{R}$ and let $c \in \mathbb{R}$. Suppose that, for some $a, b \in \mathbb{R}$
$$
\lim _{n \rightarrow \infty} a_{n}=a \,, \quad  \lim _{n \rightarrow \infty} b_{n}=b \,.
$$


*Proof of Point 1.* 

We need to show that 
$$
\lim_{n \to \infty} (a_n \pm  b_n) = a \pm b \,.
$$
We only give a proof of the formula with $+$, since the case with $-$ follows with a very similar proof. Hence, we need to show that
$$
\forall \, \e > 0 \,, \, \exists  \, N \in \N \st \forall \, n \geq N \,, \, \left|(a_{n} + b_n) - (a+b)  \right| < \e \,.
$$
Let $\e>0$ and set
$$
\widetilde{\e} := \frac{\e}{2} \,.
$$
Since $a_{n} \rightarrow a, b_n \to b$, and $\widetilde{\e}>0$, there exist $N_1, N_2 \in \N$ such that
\begin{align*}
|a_n - a| & < \widetilde{\e} \,, \quad \forall \, n \geq N_1 \,, \\
|b_n - b| & < \widetilde{\e} \,, \quad \forall \, n \geq N_2 \,.
\end{align*}
Define
$$
N : = \max  \{ N_1, N_2 \} \,.
$$
For all $n \geq N$ we have, by the triangle inequality,
\begin{align*}
\left|\left(a_{n}+b_{n}\right)-(a+b)\right| 
& = \left|\left(a_{n}-a\right) + \left(b_{n}-b\right)\right| \\
& \leq \left|a_{n}-a\right|+\left|b_{n}-b\right| \\
& < \widetilde{\e}+\widetilde{\e} \\
& =\e \,.
\end{align*}



*Proof of Point 2.*


We need to show that 
$$
\lim_{n \to \infty} (a_n  b_n) = a b  \,,
$$
which is equivalent to 
$$
\forall \, \e > 0 \,, \, \exists \, N \in \N \st  \forall \, n \geq N \,, \, \left|a_{n} b_{n} - a b \right| < \e \,.
$$
Let $\e>0$. The sequence $\left(a_{n}\right)$ converges, and hence is bounded, by Theorem \ref{theorem-convergent-bounded}. This means there exists some $M>0$ such that 
$$
\left|a_{n}\right| \leq M \,, \quad \forall \, n \in \N \,.
$$
Define 
$$
\widetilde{\e} = \frac{\e}{ M + |b| } \,. 
$$
Since $a_{n} \rightarrow a, b_n \to b$, and $\widetilde{\e} > 0$, there exist 
$N_1, N_2 \in \N$ such that
\begin{align*}
| a_n  - a | & < \widetilde{\e} \,, \quad \forall \, n \geq N_1 \,. \\
| b_n  - b | & < \widetilde{\e} \,, \quad \forall \, n \geq N_2 \,.
\end{align*}
Let 
$$
N:= \max\{ N_1, N_2 \} \,.
$$
For all $n \geq N$ we have
\begin{align*}
\left|a_{n}b_{n}-a b\right| 
& = \left|a_{n} b_{n} - a_n  b + a_n  b - a  b \right| \\
& \leq \left|a_{n}  b_{n} - a_n  b \right| + \left|a_n  b - a b \right| \\
& =\left|a_{n}\right| \left|b_{n}-b\right|+ |b|  \left|a_{n}-a\right| \\
& < M \, \widetilde{\e} +|b| \, \widetilde{\e} \\
& = (M + |b|) \, \widetilde{\e} \\
& = \e  \,.
\end{align*}


*Proof of Point 3.* 

Suppose in addition that $b_n \neq 0$ and $b \neq 0$. We need to show that
$$
\lim_{n \to \infty} \, \frac{a_n}{b_n} = \frac{a}{b} \,,
$$
which is equivalent to
$$
\forall \, \e > 0 \,, \, \exists \, N \in \N \st  \forall \, n \geq N \,, \, \left|\frac{a_{n}}{ b_{n}} - \frac{a}{b} \right| < \e \,.
$$
We suppose in addition that $b>0$. The proof is very similar for the case $b <0$, and is hence omitted. Let $\e > 0$. Set
$$
\delta := \frac{b}{2} \,.
$$
Since $b_n \to b$ and $\delta>0$, there exists $N_1 \in \N$ such that
$$
|b_n - b| < \delta \, \quad \forall \, n \geq N_1 \,.
$$
In particular we have
$$
b_n > b - \delta = b - \frac{b}{2} = \frac{b}{2}   \, \quad \forall \, n \geq N_1 \,.
$$
Define
$$
\widetilde{\e} := \frac{ b^2 }{ 2 (b + |a|)} \, \e \,.
$$
Since $\widetilde{\e}>0$ and $a_n \to a, b_n \to b$, there exist $N_2, N_3 \in \N$ such that
\begin{align*}
|a_n - a | & < \widetilde{\e} \,, \quad \forall \, n \geq N_2 \,, \\
|b_n - b | & < \widetilde{\e} \,, \quad \forall \, n \geq N_3 \,.
\end{align*}
Define
$$
N:= \max\{ N_1, N_2, N_3 \} \,.
$$
For all $n \geq N$ we have
\begin{align*}
\left|\frac{a_{n}}{ b_{n}} - \frac{a}{b} \right| & = 
\left|\frac{a_{n} b - a b_n}{ b_{n} b }  \right| \\
& = \frac{1}{ \left|b_{n} b \right|} \,  
\left| a_{n}b - a b + a b - a b_n    \right| \\
& = \frac{1}{ \left|b_{n} b \right|} \,  
\left| (a_{n} - a) b + a(b-b_n)   \right| \\
& \leq \frac{1}{ \left|b_{n} b \right|} \,  
\left( |a_{n} - a| |b| + |a| |b-b_n| \right) \\
& < \frac{1}{ \dfrac{b}{2} \, b } \, \left(  \widetilde{\e} \, b + \widetilde{\e} |a|   \right) \\
& = \frac{2 (b + |a|) }{b^2} \, \widetilde{\e} \\
& = \e \,.
\end{align*}

:::



In the future we will refer to Theorem \ref{theorem-algebra-limits} as the *Algebra of Limits*. We now show how to use Theorem \ref{theorem-algebra-limits} for computing certain limits. 


::: {.Example  #example-limit-ploynomial}
Prove that 
$$
\lim_{n \to \infty} \, \frac{3 n}{7 n+4} = \frac{3}{7} \,.
$$


> *Proof*. We can rewrite
$$
\frac{3 n}{7 n+4}=\frac{3}{7+\dfrac{4}{n}}
$$
By Theorem \ref{theorem-constant-sequence} we know that
$$
3 \rightarrow 3\,,  \quad 4 \to 4 \,, \quad 7 \to 7 \,.
$$
From Theorem \ref{theorem-one-over-n}  we know that 
$$
\frac{1}{n} \rightarrow 0 \,.
$$
Hence, it follows from Theorem \ref{theorem-algebra-limits} Point 2 that 
$$
\frac{4}{n} = 4 \cdot \frac1n \rightarrow 4 \cdot 0 = 0 \,.
$$
By Theorem \ref{theorem-algebra-limits} Point 1 we have
$$
7 + \frac{4}{n} \rightarrow  7 + 0 = 7 \,.
$$
Finally we can use Theorem \ref{theorem-algebra-limits} Point 3 to infer
$$
\frac{3 n}{7 n+4}=\frac{3}{7+\dfrac{4}{n}} \rightarrow \frac{3}{7} \,.
$$

:::


::: Important 

The technique shown in Example \ref{example-limit-ploynomial} is useful to compute limits of fractions of polynomials. To identify the possible limit, if it exists, it is often best to divide by the largest power of $n$ in the denominator.

:::



::: {.Example #example-algebra-of-limits-2}
Prove that
$$
\lim_{n \rightarrow \infty} \frac{n^{2}-1}{2 n^{2}-3} = \frac{1}{2} \,.
$$

> *Proof*. Factor $n^2$ to obtain
$$
\frac{n^{2}-1}{2 n^{2}-3} = \frac{1-\dfrac{1}{n^{2}}}{2-\dfrac{3}{n^{2}}} \,.
$$
By Theorem \ref{theorem-one-over-np} we have
$$
\frac{1}{n^2} \to 0 \,.
$$
We can then use the Algebra of Limits Theorem \ref{theorem-algebra-limits} Point 2 to infer
$$
\frac{3}{n^2} \to 3 \cdot 0 = 0
$$
and Theorem \ref{theorem-algebra-limits} Point 1 to get
$$
1 - \frac{1}{n^2} \to 1 - 0 = 1 \,, \quad 
2 - \frac{3}{n^2} \to 2 - 0 = 2 \,.
$$
Finally we use Theorem \ref{theorem-algebra-limits} Point 3 and conclude
$$
 \frac{1-\dfrac{1}{n^{2}}}{2-\dfrac{3}{n^{2}}} \to \frac{1}{2} \,.
$$
Therefore
$$
\lim_{n \to \infty } \, \frac{n^{2}-1}{2 n^{2}-3} = \lim_{n \to \infty} \, \frac{1-\dfrac{1}{n^{2}}}{2-\dfrac{3}{n^{2}}} = \frac{1}{2} \,.
$$

:::



We can also use the Algebra of Limits to prove that certain limits do not exist.



::: Example 

Prove that the sequence
$$
a_n = \frac{4 n^{3}+8 n+1}{7 n^{2}+2 n+1}
$$
does not converge.

> *Proof*. To show that the sequence $\left(a_n\right)$ does not converge, we divide by the largest power in the denominator, which in this case is $n^2$
\begin{align*}
a_n & = \frac{4 n^{3}+8 n+1}{7 n^{2}+2 n+1} \\
    & =\frac{4 n+ \dfrac{8}{n}  +  \dfrac{1}{n^{2}} }{7+  \dfrac{2}{n}  +  \dfrac{1}{n^{2}} } \\
    & = \frac{b_n}{c_n}
\end{align*}
where we set 
$$
b_n := 4 n+ \dfrac{8}{n}  +  \dfrac{1}{n^{2}}\,, \quad
c_n := 7 + \dfrac{2}{n}  +  \dfrac{1}{n^{2}} \,.
$$
Using the Algebra of Limits Theorem \ref{theorem-algebra-limits} we see that
$$
c_n = 7+  \dfrac{2}{n}  +  \dfrac{1}{n^{2}}  \to 7 \,.
$$
Suppose by contradiction that
$$
a_n \to a
$$
for some $a \in \R$. Then, by the Algebra of Limits Theorem \ref{theorem-algebra-limits} we would infer
$$
b_n = c_n \cdot a_n \to 7 a \,,
$$
concluding that $b_n$ is convergent to $7a$. We have that
$$
b_n = 4n + d_n \,, \quad d_n := \dfrac{8}{n}  +  \dfrac{1}{n^{2}} \,.
$$
Again by the Algebra of Limits Theorem \ref{theorem-algebra-limits} we get that 
$$
d_n =  \dfrac{8}{n}  +  \dfrac{1}{n^{2}} \to 0 \,,
$$
and hence
$$
4n = b_n - d_n \to 7a - 0 = 7a \,.
$$
This is a contradiction, since the sequence $(4n)$ is unbounded, and hence cannot be convergent. Hence $(a_n)$ is not convergent.
:::



::: Warning

Consider the sequence 
$$
a_n = \frac{4 n^{3}+8 n+1}{7 n^{2}+2 n+1}
$$
from the previous example. We have proven that $(a_n)$ is not convergent, by making use of the Algebra of Limits. 

Let us review a **faulty** argument to conclude that $(a_n)$ is not convergent. Write
$$
a_n = \frac{b_n}{c_n} \,, \quad b_n:= 4 n^{3}+8 n+1\,, 
\quad c_n : =7 n^{2}+2 n+1 \,.
$$
The numerator 
$$
b_n = 4 n^{3}+8 n+1
$$
and denominator 
$$
c_n  =7 n^{2}+2 n+1 
$$
are both unbounded, and hence $(b_n)$ and $(c_n)$ do not converge. One might be tempted to conclude that $(a_n)$ does not converge. However this is **false** in general: as seen in 
Example \ref{example-algebra-of-limits-2}, we have
$$
\lim_{n \rightarrow \infty} \frac{n^{2}-1}{2 n^{2}-3} = \frac{1}{2} \,,
$$
while numerator and denominator are unbounded.

:::





Sometimes it is useful to rearrange the terms of a sequence, before applying the Algebra of Limits.



::: Example 

Define 
$$
 a_n := \frac{2 n^{3}+7 n+1}{5 n+9} \cdot \frac{8 n+9}{6 n^{3}+8 n^{2}+3} \,.
$$
Prove that 
$$
\lim_{n \to \infty}  a_n = \frac{8}{15} \,.
$$


> *Proof.* 
The first fraction in $(a_n)$ does not converge, as it is unbounded. Therefore we cannot use Point 2 in Theorem \ref{theorem-algebra-limits} directly. However, we note that
\begin{align*}
a_{n} & =\frac{2 n^{3}+7 n+1}{5 n+9} \cdot \frac{8 n+9}{6 n^{3}+8 n^{2}+3} \\
& = \frac{8 n+9}{5 n+9} \cdot \frac{2 n^{3}+7 n+1}{6 n^{3}+8 n^{2}+3} \,.
\end{align*}
Factoring out $n$ and $n^3$, respectively, and using the Algebra of Limits, we see that
$$
\frac{8 n+9}{5 n+9}=\frac{8+9 / n}{5+9 / n} \to \frac{8+0}{5+0}=\frac{8}{5}
$$
and
$$
\frac{2+7 / n^{2}+1 / n^{3}}{6+8 / n+3 / n^{3}} \to \frac{2+0+0}{6+0+0}=\frac{1}{3}
$$
Therefore Theorem \ref{theorem-algebra-limits} Point 2 ensures that
$$
a_{n} \to \frac{8}{5} \cdot \frac{1}{3}=\frac{8}{15} \,.
$$

:::





## Fractional powers


The Algebra of Limits Theorem \ref{theorem-algebra-limits} can also be used when fractional powers of $n$ are involved.

::: Example

Prove that 
$$
a_n = \frac{n^{7 / 3}+2 \sqrt{n}+7}{4 n^{3 / 2}+5 n}
$$
does not converge.

> *Proof*. The largest power of $n$ in the denominator is $n^{3/2}$. Hence we factor out $n^{3/2}$
\begin{align*}
a_n & = \frac{n^{7 / 3}+2 \sqrt{n}+7}{4 n^{3 / 2}+5 n} \\
    & = \frac{n^{7 / 3-3 / 2}+2 n^{1/2 - 3/2} + 7  n^{-3 / 2}}{4 + 5 n^{-3/2} } \\
    & = \frac{n^{5/6}+2 n^{- 1} + 7  n^{-3 / 2}}{4 + 5 n^{-3/2} } \\
    & = \frac{b_n}{c_n}
\end{align*}
where we set
$$
b_n := n^{5/6}+2 n^{- 1} + 7  n^{-3 / 2} \,, \quad 
c_n := 4 + 5 n^{-3/2} \,.
$$
We see that $b_n$ is unbounded while $c_n \to 4$. By the Algebra of Limits (and usual contradiction argument) we conclude that $(a_n)$ is divergent.

:::



We now present a general result about the square root of a sequence.

::: {.Theorem #theorem-square-root-limit}

Let $\left(a_{n}\right)_{n \in \mathbb{N}}$ be a sequence in $\mathbb{R}$ such that 
$$
\lim_{n \to \infty} \, a_n = a \,,
$$
for some $a \in \R$. If $a_{n} \geq 0$ for all $n \in \mathbb{N}$ and $a \geq 0$, then
$$
\lim _{n \rightarrow \infty} \sqrt{a_{n}}=\sqrt{a} \,.
$$

:::


::: Proof 

Let $\e>0$. We the two cases $a>0$ and $a=0$:

- $a>0$: Define
$$
\delta := \frac{a}{2} \,.
$$
Since $\delta > 0$ and $a_n \to a$, there exists $N_1 \in \N$ such that
$$
\left|a_{n}-a\right| < \delta \,, \quad \forall \, n \geq N_1 \,. 
$$
In particular
$$
a_n > a - \delta = a - \frac{a}{2} = \frac{a}{2} \,, \quad \forall \, n \geq N_1 \,,
$$
from which we infer
$$
\sqrt{a_n} > \sqrt{a/2} \,, \quad \forall \, n \geq N_1 \,,
$$
Now set
$$
\widetilde{\e} := \left(\sqrt{a/2} + \sqrt{a} \right) \, \e \,.
$$
Since $\widetilde{\e}>0$ and $a_n \to a$, there exists $N_2 \in \mathbb{N}$ such that 
$$
\left|a_{n}-a\right| < \widetilde{\e} \,, \quad \forall \, n \geq N_2 \,. 
$$
Let 
$$
N:= \max\{  N_1, N_2 \} \,.
$$
For $n \geq N$ we have
\begin{align*}
\left|\sqrt{a_{n}}-\sqrt{a}\right| 
& = \left|\frac{\left(\sqrt{a_{n}}-\sqrt{a}\right)\left(\sqrt{a_{n}}+\sqrt{a}\right)}{\sqrt{a_{n}}+\sqrt{a}}\right| \\
& = \frac{\left|a_{n}-a\right|}{\sqrt{a_{n}}+\sqrt{a}} \\
& < \frac{ \widetilde{\e} }{\sqrt{a/2} + \sqrt{a}}  \\
& = \e \,.
\end{align*}


- $a=0$: In this case
$$
a_n \to a = 0 \,.
$$
Since $\e^2>0$, there exists $N \in \N$ such that
$$
|a_n - 0 | = |a_n| < \e^2 \,, \quad \forall \, n \geq N \,.
$$
Therefore
$$
|\sqrt{a_n} - \sqrt{0} | = | \sqrt{a_n}| < \sqrt{\e^2} = \e \,, \quad \forall \, n \geq N \,.
$$


:::


Let us show an application of Theorem \ref{theorem-square-root-limit}.


::: Example 

Define the sequence
$$
a_n  = \sqrt{9 n^{2}+3 n+1}-3 n \,.
$$
Prove that
$$
\lim_{n \to \infty} \, a_n = \frac12 \,.
$$


> *Proof*. We first rewrite
\begin{align*}
a_n & = \sqrt{9 n^{2}+3 n+1}-3 n \\
& = \frac{\left(\sqrt{9 n^{2}+3 n+1}-3 n\right)\left(\sqrt{9 n^{2}+3 n+1}+3 n\right)}{\sqrt{9 n^{2}+3 n+1}+3 n} \\
& =\frac{9 n^{2}+3 n+1-(3 n)^{2}}{\sqrt{9 n^{2}+3 n+1}+3 n} \\
& =\frac{3 n+1}{\sqrt{9 n^{2}+3 n+1}+3 n} \, .
\end{align*}
The biggest power of $n$ in the denominator is $n$. Therefore we factor out $n$:
\begin{align*}
a_n & = \sqrt{9 n^{2}+3 n+1}-3 n \\
& =\frac{3 n+1}{\sqrt{9 n^{2}+3 n+1}+3 n} \\
& =\frac{3+ \dfrac{1}{n} }{\sqrt{9+ \dfrac{3}{n} + \dfrac{1}{n^{2}}} + 3 } \,.
\end{align*}
By the Algebra of Limits we have
$$
9+ \frac{3}{n} + \frac{1}{n^{2}} \to 9 + 0 + 0 = 9 \,.
$$
Therefore we can use Theorem \ref{theorem-square-root-limit} to infer
$$
\sqrt{ 9 + \frac{3}{n} + \frac{1}{n^{2}} } \to \sqrt{9}  \,.
$$
By the Algebra of Limits we conclude:
$$
a_n = \frac{3+ \dfrac{1}{n} }{\sqrt{9+ \dfrac{3}{n}  + \dfrac{1}{n^{2}} }+ 3 }   \to  \frac{ 3 + 0 }{ \sqrt{9} + 3 } = \frac12 \,.
$$


:::


::: Example 

Prove that the sequence
$$
a_n = \sqrt{9 n^{2}+3 n+1}-2 n
$$
does not converge.

> *Proof.* We rewrite $a_n$ as
\begin{align*}
a_n & = \sqrt{9 n^{2}+3 n+1}-2 n  \\
& =\frac{  (\sqrt{9 n^{2}+3 n+1} - 2 n)  (\sqrt{9 n^{2}+3 n+1}+2 n) }{\sqrt{9 n^{2}+3 n+1}+2 n} \\
& =\frac{9 n^{2}+3 n+1-(2 n)^{2}}{\sqrt{9 n^{2}+3 n+1}+2 n} \\
& =\frac{5 n^{2}+3 n+1}{\sqrt{9 n^{2}+3 n+1}+2 n} \\
& =\frac{5 n + 3 +  \dfrac{1}{n} }{\sqrt{9+ \dfrac{3}{n}  + \dfrac{1}{ n^2 } } + 2 } \\
& = \frac{b_n}{c_n} \,,
\end{align*}
where we factored $n$, being it the largest power of $n$ in the denominator, and defined
$$
b_n : = 5 n + 3 +  \dfrac{1}{n}\,, \quad 
c_n := \sqrt{9+ \dfrac{3}{n}  + \dfrac{1}{ n^2 } } + 2 \,.
$$
Note that 
$$
9+ \dfrac{3}{n}  + \dfrac{1}{ n^2 }  \to 9
$$
by the Algebra of Limits. Therefore 
$$
\sqrt{9+ \dfrac{3}{n}  + \dfrac{1}{ n^2 }}  \to \sqrt{9} = 3 
$$
by Theorem \ref{theorem-square-root-limit}. Hence 
$$
c_n = \sqrt{9+ \dfrac{3}{n}  + \dfrac{1}{ n^2 }} + 2 \to 3 + 2 = 5  \,.
$$
The numerator 
$$
b_n = 5 n + 3 +  \dfrac{1}{n}
$$
is instead unbounded. Therefore $(a_n)$ is not convergent, by the Algebra of Limits and the usual contradiction argument.
:::







## Limit Tests


In this section we discuss a number of *Tests* to determine whether a sequence converges or not. These are known as **Limit Tests**.


### Squeeze Theorem


When a sequence $(a_n)$ oscillates, it is difficult to compute the limit. Examples of terms which produce oscillations are
$$
(-1)^n \,, \quad  \sin(n) \,, \quad \cos(n) \,. 
$$
In such instance it might be useful to compare $(a_n)$ with other sequences whose limit is known. If we can prove that $(a_n)$ is *squeezed* between two other sequences with the same limiting value, then we can show that also $(a_n)$ converges to this value.



::: Theorem 
### Squeeze theorem {#theorem-squeeze}

Let $\left(a_{n}\right), \left(b_{n}\right)$ and $\left(c_{n}\right)$ be sequences in $\R$. Suppose that
$$
b_{n} \leq a_{n} \leq c_{n} \,, \quad \forall  \, n \in \N \,,
$$
and that
$$
\lim_{n \rightarrow \infty} b_{n} = \lim_{n \rightarrow \infty} c_{n} = L \, .
$$
Then
$$
\lim_{n \rightarrow \infty} a_{n}= L \, .
$$

:::


::: Proof

Let $\e>0$. Since $b_{n} \to L$ and $c_n \to L$ , there exist $N_1, N_2 \in \N$ such that 
\begin{align*}
-\e < b_n - L < \e \,, \,\, \forall \, n \geq N_1 \,,  \\
- \e < c_n - L < \e \,, \,\, \forall \, n \geq N_2 \,. 
\end{align*}
Set
$$
N := \max\{N_1,N_2\} \,.
$$
Let $n \geq N$. Using the assumption that $b_n \leq a_{n} \leq c_{n}$, we get
$$
b_n - L  \leq a_{n} - L \leq c_{n} - L \,.
$$
In particular
$$
- \e < b_n - L  \leq a_n - L \leq b_n - L < \e \,.
$$
The above implies 
$$
- \e < a_n - L < \e  \quad \implies \quad \left|a_{n}-L\right| < \e \,.
$$

:::



::: Example 

Prove that
$$
\lim_{n \to \infty} \, \frac{(-1)^{n}}{n} = 0 \,.
$$

> *Proof.*
For all $n \in \N$ we can estimate
$$
-1 \leq(-1)^{n} \leq 1 \,.
$$
Therefore
$$
\frac{-1}{n} \leq \frac{(-1)^{n}}{n} \leq \frac{1}{n} \,, \quad \forall \, n \in \N \,.
$$
Moreover
$$
\lim_{n \to \infty} \frac{-1}{n}= -1 \cdot 0=0 \,, \quad 
\lim_{n \to \infty} \frac{1}{n}=0 \,.
$$
By the Squeeze Theorem \ref{theorem-squeeze} we conclude
$$
\lim_{n \to \infty} \frac{(-1)^{n}}{n}=0 \,.
$$

:::



::: {.Example #example-squeeze}

Prove that 
$$
\lim_{n \to \infty} \frac{\cos (3 n) + 9 n^{2}}{11 n^{2}+15 \sin (17 n)} = \frac{9}{11} \,.
$$


> *Proof.* 
We know that 
$$
-1 \leq \cos(x) \leq 1 \,, \quad - 1 \leq \sin(x) \leq 1 \,, \quad \forall \, x \in \R \,.
$$
Therefore, for all $n \in \N$
$$
- 1 \leq \cos(3n) \leq 1 \,, \quad -1 \leq \sin(17n) \leq 1 \,.
$$
We can use the above to estimate the numerator in the given sequence:
$$
-1 + 9 n^{2} \leq \cos (3 n)+9 n^{2} \leq 1+ 9 n^{2} \,.
$${#eq-squeeze-example-1}
Concerning the denominator, we have
$$
11 n^{2}-15 \leq 11 n^{2}+15 \sin (17 n) \leq  11 n^{2} + 15
$$
and therefore
$$
\frac{1}{11 n^{2} + 15} \leq \frac{1}{11 n^{2}+15 \sin (17 n)} \leq \frac{1}{11 n^{2}-15} \,.
$${#eq-squeeze-example-2}
Putting together (@eq-squeeze-example-1)-(@eq-squeeze-example-2) we obtain 
$$
\frac{-1 + 9 n^{2}}{11 n^{2} + 15} \leq \frac{\cos (3 n)+9 n^{2}}{11 n^{2}+15 \sin (17 n)} \leq \frac{1+ 9 n^{2}}{11 n^{2}-15} \,.
$$
By the Algebra of Limits we infer
$$
\frac{-1+9 n^{2}}{11 n^{2}+15}=\frac{-\dfrac{1}{n^{2}} + 9}{11 + \dfrac{15}{n^{2}}} \to \frac{0+9}{11+0}=\frac{9}{11}
$$
and
$$
\frac{1+9 n^{2}}{11 n^{2} - 15}=\frac{ \dfrac{1}{n^{2}} + 9}{ 11 - \dfrac{15}{n^{2}}} \to \frac{0+9}{11+0}=\frac{9}{11} \,.
$$
Applying the Squeeze Theorem \ref{theorem-squeeze} we conclude
$$
\lim_{n \to \infty} \frac{\cos (3 n)+ 9 n^{2}}{11 n^{2}+15 \sin (17 n)}=\frac{9}{11} \,.
$$

:::
 
::: Warning

Suppose that the sequences $(a_n), (b_n), (c_n)$ satisfy
$$
b_n \leq a_n \leq c_n \,, \quad \forall n \in \N \,,
$$
and
$$
b_n \to L_1 \,, \quad c_n \to L_2 \,, \quad L_1 \neq L_2 \,.
$$
In general, we cannot conclude that $a_n$ converges.

:::


::: Example 

Consider the sequence
$$
a_n = \left( 1 + \frac{1}{n} \right) (-1)^n  \,.
$$
For all $n \in \N$ we can bound
$$
- 1 - \frac{1}{n} \leq \left( 1 + \frac{1}{n} \right) (-1)^n   \leq 1 + \frac{1}{n}  \,.
$$
However 
$$
- 1 - \frac{1}{n} \longrightarrow - 1 - 0 = -1 
$$
and
$$
1 + \frac{1}{n}  \longrightarrow  1 + 0 = 1 \,.
$$
Since 
$$
- 1 \neq 1 \,,
$$
we cannot apply the Squeeze Theorem \ref{theorem-squeeze} to conclude convergence of $(a_n)$. Indeed, $(a_n)$ is a divergent sequence.

> *Proof.* Suppose by contradiction that $a_n \to a$. We have
$$
a_n = (-1)^n + \frac{(-1)^n}{n} = b_n + c_n
$$
where
$$
b_n := (-1)^n \,, \quad c_n := \frac{(-1)^n}{n} \,.
$$
We have seen in Example \ref{example-squeeze} that $c_n \to 0$. Therefore, 
by the Algebra of Limits, we have
$$
b_n = a_n - c_n \longrightarrow a - 0 = a \,.
$$
However, Theorem \ref{theorem-1-minus-n} says that the sequence
$b_n = (-1)^n$ diverges. Contradiction. Hence $(a_n)$ diverges.

:::





### Geometric sequences


::: Definition 

A sequence $\left(a_{n}\right)$ is called a **geometric sequence** if
$$
a_{n}=x^{n} \,,
$$
for some $x \in \R$.

:::


The value of $|x|$ determines whether or not a geometric sequence converges, as shown in the following theorem.


::: Theorem 
### Geometric Sequence Test   {#theorem-geometric-sequence}

Let $x \in \R$ and let $\left(a_{n}\right)$ be the sequence defined by
$$
a_{n}:=x^{n} \,.
$$
We have:

1. If $|x|<1$, then 
$$
\lim_{n \to \infty} a_{n} = 0 \,.
$$

2. If $|x|>1$, then sequence $\left(a_{n}\right)$ is unbounded, and hence divergent.

:::



::: Warning

The Geometric Sequence Test in Theorem \ref{theorem-geometric-sequence} does not address the case
$$
|x|=1 \,.
$$
This is because, in this case, the sequence 
$$
a_n = x^n 
$$
might converge or diverge, depending on the value of $x$. Indeed, 
$$
|x| = 1 \quad \implies \quad x = \pm 1 \,.
$$
We therefore have two cases:

- $x = 1$: Then 
$$
a_n = 1^n = 1
$$
so that $a_n \to 1$ and $(a_n)$ is convergent.

- $x=-1$: Then
$$
a_n = x^n = (-1)^n
$$
which is divergent by Theorem \ref{theorem-1-minus-n}.

:::



To prove Theorem \ref{theorem-geometric-sequence} we need the following inequality, known as Bernoulli's inequality.


::: Lemma 
### Bernoulli's inequality  {#lemma-bernoulli}

Let $x \in \R$ with $x>-1$. Then
$$
(1+x)^{n} \geq 1+n x \,, \quad \forall \, n \in \N \,.
$${#eq-bernoulli-inequality}

:::


::: Proof

Let $x \in \mathbb{R}, x>-1$. We prove the statement by induction:

- Base case: (@eq-bernoulli-inequality) holds with equality when $n=1$.

- Induction hypothesis: Let $k \in \N$ and suppose that (@eq-bernoulli-inequality) holds for $n=k$, i.e.,
$$
(1+x)^{k} \geq 1+k x \,.
$$
Then
\begin{align*}
(1+x)^{k+1} & = (1+x)^{k}(1+x) \\
            & \geq(1+k x)(1+x) \\
            & =1+k x+x+k x^{2} \\
            & \geq 1+(k+1) x \,,
\end{align*}
where we used that $kx^2 \geq 0$. Then (@eq-bernoulli-inequality) holds for $n=k+1$.

By induction we conclude (@eq-bernoulli-inequality).

:::


We are ready to prove Theorem \ref{theorem-geometric-sequence}.


::: Proof 
### Proof of Theorem \ref{theorem-geometric-sequence}

*Part 1. The case $|x|<1$*. 

If $x=0$, then
$$
a_n = x^n = 0 
$$
so that $a_n \to 0$. Hence assume $x \neq 0$. We need to prove that
$$
\forall \, \e> 0 \,, \, \exists \, N \in \N \st 
\forall \, n \geq N \,, \,\, |x^n - 0| < \e \,.
$$
Let $\e>0$. We have 
$$
|x| < 1 \quad \implies \quad \frac{1}{|x|} > 1 \,.
$$
Therefore 
$$
|x|= \frac{1}{1+u} \,, \quad u:=\frac{1}{|x|} - 1 > 0 \,.
$$
Let $N \in \N$ be such that 
$$
N > \frac{1}{\e u} \,,
$$
so that 
$$
\frac{1}{N u} < \e \,.
$$
Let $n \geq N$. Then
\begin{align*}
\left|x^{n}-0\right| & =|x|^{n} \\
                     & = \left(\frac{1}{1+u}\right)^{n} \\
                     & =\frac{1}{(1+u)^{n}} \\
                     & \leq \frac{1}{1+n u} \\
                     & \leq \frac{1}{n u} \\
                     & \leq \frac{1}{N u} \\
                     & < \e \,,
\end{align*}
where we used Bernoulli's inequality (@eq-bernoulli-inequality) in the first inequality.


*Part 2. The case $|x|>1$*. 

To prove that $(a_n)$ does not converge, we prove that it is unbounded. 
This means showing that
$$
\forall \, M > 0 \,, \, \exists n \in \N \st  \left| a_{n}\right| >M \,.
$$
Let $M > 0$. We have two cases: 

- $0 < M \leq 1$: Choose $n=1$. Then
$$
\left|a_{1}\right|=|x|>1 \geq M \,.
$$

- $M>1$: Choose $n \in \N$ such that 
$$
n> \frac{\log M}{\log |x|} \,.
$$ 
Note that $\log |x|>0$ since $|x|>1$. Therefore
\begin{align*}
n>\frac{\log M}{\log |x|} & \iff n \log |x|>\log M \\
                          & \iff \log |x|^n>\log M \\
                          & \iff |x|^{n}>M \,.
\end{align*}
Then 
$$
\left|a_{n}\right|=\left|x^{n}\right|=|x|^{n} > M \,.
$$


Hence $(a_n)$ is unbounded. By Corollary \ref{corollary-convergent-bounded} we conclude that $(a_n)$ is divergent. 


:::






::: Example 

We can apply Theorem \ref{theorem-geometric-sequence} to prove convergence
or divergence for the following sequences.

1. We have
$$
\left(\frac{1}{2}\right)^{n} \longrightarrow 0
$$
since 
$$
\left|\frac{1}{2}\right|=\frac{1}{2}<1 \,.
$$

2. We have
$$
\left(\frac{-1}{2}\right)^{n} \longrightarrow 0
$$
since 
$$
\left|\frac{-1}{2}\right|=\frac{1}{2}<1 \,.
$$

3. The sequence 
$$
a_n = \left(\frac{-3}{2}\right)^{n}
$$ 
does not converge, since 
$$
\left|\frac{-3}{2}\right|=\frac{3}{2}>1 \,.
$$

4. As $n \rightarrow \infty$,
$$
\frac{3^{n}}{(-5)^{n}}=\left(-\frac{3}{5}\right)^{n} \longrightarrow 0
$$
since 
$$
\left|-\frac{3}{5}\right|=\frac{3}{5}<1 \,.
$$

5. The sequence 
$$
a_{n}=\frac{(-7)^{n}}{2^{2 n}}
$$ 
does not converge, since
$$
\frac{(-7)^{n}}{2^{2 n}}=\frac{(-7)^{n}}{\left(2^{2}\right)^{n}}=\left(-\frac{7}{4}\right)^{n}
$$
and 
$$
\left|-\frac{7}{4}\right|=\frac{7}{4}>1  \,.
$$

:::







### Ratio Test



::: Theorem 
### Ratio Test {#theorem-ratio-test}

Let $\left(a_{n}\right)$ be a sequence in $\R$ such that
$$
a_{n} \neq 0 \,, \quad \forall \, n \in \N \,.
$$ 


1. Suppose that the following limit exists:
$$
L:=\lim_{n \to \infty}\left|\frac{a_{n+1}}{a_{n}}\right| \,.
$$
Then,

    - If $L<1$ we have
    $$
    \lim_{n \to\infty} a_{n}=0 \,.
    $$

    - If $L>1$, the sequence $\left(a_{n}\right)$ is unbounded, and hence does not converge.

2. Suppose that there exists $N \in \N$ and $L>1$ such that
$$
\left|\frac{a_{n+1}}{a_{n}}\right| \geq L \,, \quad \forall \, n \geq N \,. 
$$
Then the sequence $\left(a_{n}\right)$ is unbounded, and hence does not converge.

:::



::: Proof

Define the sequence $b_{n}=\left|a_{n}\right|$. Then,

$$
\left|\frac{a_{n+1}}{a_{n}}\right|=\frac{\left|a_{n+1}\right|}{\left|a_{n}\right|}=\frac{b_{n+1}}{b_{n}}
$$


*Part 1.* Suppose that there exists the limit
$$
L:=\lim_{n \to \infty}\left|\frac{a_{n+1}}{a_{n}}\right| \,.
$$
Therefore 
$$
\lim_{n \to \infty} \frac{b_{n+1}}{b_{n}} = L \,.
$${#eq-ratio-test-proof}

- $L<1$: Choose $r>0$ such that 
$$
L<r<1 \,.
$$
Set 
$$
\e := r-L
$$
By the convergence at (@eq-ratio-test-proof) there exists $N \in \N$ such that
$$
\left|\frac{b_{n+1}}{b_{n}}-L\right| < \e = r - L \,, \quad \forall \, n \geq N \,.
$$
In particular 
$$
\frac{b_{n+1}}{b_{n}}-L < r-L \,, \quad \forall \, n \geq N \,,
$$
which implies 
$$
b_{n+1} <  r \,{b_{n}} \,, \quad \forall \, n \geq N \,.
$${#eq-ratio-test-proof-1}
Let $n \geq N$, we can use (@eq-ratio-test-proof-1) recursively and obtain
$$
0 \leq b_{n} < \, r b_{n-1} < \ldots < r^{n-N} \, b_{N} = r^{n} \, \frac{b_{N}}{r^{N}} \,.
$$
In particular, we have proven that
$$
0 \leq b_{n} < r^{n} \, \frac{b_{N}}{r^{N}} \,, \quad \forall \, n \in \N \,.
$${#eq-ratio-test-proof-2}
Since $|r|<1$, by the Geometric Sequence Test Theorem \ref{theorem-geometric-sequence} we infer
$$
r^{n} \rightarrow 0 \,.
$$
The Algebra of Limits the yields
$$
r^{n} \, \frac{b_{N}}{r^{N}} \rightarrow 0 \,.
$$
By the Squeeze Theorem \ref{theorem-squeeze} applied to (@eq-ratio-test-proof-2), it follows that 
$$   
b_{n} = |a_n| \to 0 \,.
$$
Since 
$$
-\left|a_{n}\right| \leq a_{n} \leq\left|a_{n}\right| \,,
$$
and 
$$
-|a_n| \to 0 \,, \quad |a_n| \to 0 \,, 
$$
we can again apply the Squeeze Theorem \ref{theorem-squeeze} to infer
$$
a_{n} \rightarrow 0 \,.
$$


- $L>1$: Choose $r>0$ such that 
$$
1<r<L  \,.
$$
Define
$$
\e := L - r > 0 \,.
$$
By the convergence (@eq-ratio-test-proof), there exists $N \in \N$ such that
$$
\left|\frac{b_{n+1}}{b_{n}}-L\right| < \e = L - r \,, \quad \forall \, n \geq N \,.
$$
In particular,
$$
-(L-r) < \frac{b_{n+1}}{b_{n}}-L \,, \quad \forall \, n \geq N \,,
$$
which implies
$$
b_{n+1} > r \, b_{n} \,, \quad  \forall \, n \geq N \,.
$${#eq-ratio-test-proof-4}
Let $n \geq N$. Applying (@eq-ratio-test-proof-4) recursively we get
$$
b_{n} > r^{n-N} \, b_{N} = r^{n} \, \frac{b_{N}}{r^{N}} \,, \quad \forall \, n \geq N \,.
$${#eq-ratio-test-proof-5}
Since $|r|>1$, by the Geometric Sequence Test we have that the sequence
$$
(r^n)
$$
is unbounded. Therefore also the right hand side of (@eq-ratio-test-proof-5) is unbounded, proving that $(b_n)$ is unbounded. Since
$$
b_n = |a_n|\,,
$$
we conclude that $(a_n)$ is unbounded. By Corollary \ref{corollary-convergent-bounded} we conclude that $(a_n)$ does not converge.


*Part 2.* Suppose that there exists $N \in \N$ and $L>1$ such that
$$
\left|\frac{a_{n+1}}{a_{n}}\right| \geq L \,, \quad \forall \, n \geq N \,. 
$$
Since $b_n = |a_n|$, we infer
$$
b_{n+1} \geq L \, b_n \,, \quad \forall \, n \geq N \,. 
$$
Arguing as above, we obtain
$$
b_n \geq L^n \, \frac{b_N}{L^N} \,, \quad \forall \, n \geq N \,.
$$
Since $L>1$, we have that the sequence 
$$  
L^n \, \frac{b_N}{L^N}
$$
is unbounded, by the Geometric Sequence Test. Hence also $(b_n)$ is unbounded, from which we conclude that $(a_n)$ is unbounded. By Corollary \ref{corollary-convergent-bounded} we conclude that $(a_n)$ does not converge.


:::


Let us apply the Ratio Test to some concrete examples.



::: Example


Let 
$$
a_{n}=\frac{3^{n}}{n !} \,,
$$
where we recall that $n!$ (pronounced $n$ factorial) is defined by
$$
n! := n \cdot (n-1) \cdot (n-2) \cdot  \ldots \cdot  3 \cdot 2 \cdot 1 \,. 
$$
Prove that
$$
\lim_{n \to \infty} a_n  = 0 \,.
$$

> *Proof*. We have
\begin{align*}
\left|\frac{a_{n+1}}{a_{n}}\right| & = \dfrac{\left( \dfrac{3^{n+1}}{(n+1) !} \right) }{  \left( \dfrac{3^{n}}{n !} \right) } \\
& = \frac{3^{n+1}}{3^{n}} \, \frac{n !}{(n+1) !} \\
& = \frac{3 \cdot 3^n}{3^n} \, \frac{n!}{(n+1) n!} \\
& =\frac{3}{n+1} \longrightarrow L = 0 \,.
\end{align*}
Hence, $L=0<1$ so $a_{n} \to 0$ by the Ratio Test in Theorem \ref{theorem-ratio-test}.

:::


::: Example

Consider the sequence
$$
a_{n}=\frac{n ! \cdot 3^{n}}{\sqrt{(2 n) !}} \,.
$$
Prove that $(a_n)$ is divergent.

> *Proof.* We have
\begin{align*}
\left|\frac{a_{n+1}}{a_{n}}\right| & =\frac{(n+1) ! \cdot 3^{n+1}}{\sqrt{(2(n+1)) !}}  \frac{\sqrt{(2 n) !}}{n ! \cdot 3^{n}} \\
& =\frac{(n+1) !}{n !} \cdot \frac{3^{n+1}}{3^{n}} \cdot \frac{\sqrt{(2 n) !}}{\sqrt{(2(n+1)) !}}
\end{align*}
For the first two fractions we have
$$
\frac{(n+1) !}{n !} \cdot \frac{3^{n+1}}{3^{n}} = 3(n+1) \,,
$$
while for the third fraction
\begin{align*}
\frac{\sqrt{(2 n) !}}{\sqrt{(2(n+1)) !}} & =\sqrt{\frac{(2 n) !}{(2 n+2) !}} \\
& = \sqrt{\frac{ (2n)! }{ (2n+2) \cdot (2n+1) \cdot (2n)! }} \\
& = \frac{1}{\sqrt{(2 n+1)(2 n+2)}} \,.
\end{align*}
Therefore, using the Algebra of Limits,
\begin{align*}
\left|\frac{a_{n+1}}{a_{n}}\right| & = \frac{3(n+1)}{\sqrt{(2 n+1)(2 n+2)}}\\
& = \frac{3n \left(1+ \dfrac{1}{n} \right)}{\sqrt{n^2 \left( 2 + \dfrac{1}{n}\right) \left(2 + \dfrac{2}{n} \right)}} \\
& = \frac{3 \left(1+ \dfrac{1}{n} \right)}{\sqrt{ \left( 2 + \dfrac{1}{n}\right) \left(2 + \dfrac{2}{n} \right)}}  \longrightarrow \frac{3}{\sqrt{4}} = \frac{3}{2} > 1 \,.
\end{align*}
By the Ratio Test we conclude that $(a_n)$ is divergent.

:::



::: Example 

Let 
$$
a_{n}=\frac{n !}{100^{n}} \,.
$$
Prove that $(a_n)$ is divergent.

> *Proof.*
$$
\left|\frac{a_{n+1}}{a_{n}}\right| 
= \frac{100^{n}}{100^{n+1}} \frac{(n+1) !}{n !}
=\frac{n+1}{100} \,.
$$
Choose $N=101$. Then for all $n \geq N$,
$$
\left|\frac{a_{n+1}}{a_{n}}\right| \geq \frac{101}{100}>1 \,.
$$
Hence $a_{n}$ is divergent by the Ratio Test.

:::




::: Warning

The Ratio Test in Theorem \ref{theorem-ratio-test} does not address the case
$$
L=1 \,.
$$
This is because, in this case, the sequence $(a_n)$ 
might converge or diverge. 

For example:

- Define the sequence
$$
a_n = \frac1n \,.
$$
We have
$$
\left|\frac{a_{n+1}}{a_{n}}\right| = \frac{n}{n+1} \rightarrow L = 1 \,. 
$$
Hence we cannot apply the Ratio Test. However we know that 
$$
\lim_{n \to \infty} \, \frac1n = 0 \,.
$$


- Consider the sequence
$$
a_n = n \,.
$$
We have
$$
\frac{|a_{n+1}|}{|a_n|} = \frac{n+1}{n} \rightarrow L = 1 \,. 
$$
Hence we cannot apply the Ratio Test. However we know that $(a_n)$ is unbounded, and thus divergent.

:::



If the sequence $(a_n)$ is geometric, the Ratio Test of Theorem \ref{theorem-ratio-test} will give the same
answer as the Geometric Sequence Test of Theorem \ref{theorem-geometric-sequence}. This is the content of the following remark.


::: Remark

Let $x \in \R$ and define the geometric sequence 
$$
a_{n}=x^{n} \,.
$$
Then
$$
\left|\frac{a_{n+1}}{a_{n}}\right|  = \frac{\left|x^{n+1}\right|}{\left|x^{n}\right|} 
= \frac{|x|^{n+1}}{|x|^{n}} 
 =|x| \rightarrow |x| \,.
$$
Hence: 

- If $|x|<1$, the sequence $(a_n)$ converges by the Ratio Test
- If $|x|>1$, the sequence $(a_n)$ diverges by the Ratio Test. 
- If $|x|=1$, the sequence $(a_n)$ might be convergent or divergent.

These results are in agreement with the Geometric Sequence Test. 

:::






## Monotone sequences


We have seen in Theorem \ref{theorem-convergent-bounded} that convergent sequences are bounded. We noted that the converse statement is not true. 
For example the sequence
$$
a_n = (-1)^n
$$
is bounded but not convergent, as shown in Theorem \ref{theorem-1-minus-n}.
On the other hand, if a bounded sequence is **monotone**, then it is convergent.


::: Definition
### Monotone sequence

Let $(a_n)$ be a real sequence. We say that:

1. $(a_n)$ is **increasing** if 
$$
a_n \leq a_{n+1} \,, \quad \forall \, n \geq N \,.
$$

2. $(a_n)$ is **decreasing** if 
$$
a_n \geq a_{n+1} \,, \quad \forall \, n \geq N \,.
$$

3. $(a_n)$ is **monotone** if it is either increasing or decreasing.

:::



::: Example


- The sequence below is increasing
$$
b_n = \frac{n-1}{n} \,.
$$

  > We have
  $$
  b_{n+1} = \frac{n}{n+1} > \frac{n-1}{n} = b_n \,,
  $$
  where the inequality holds because
  \begin{align*}
  \frac{n}{n+1} > \frac{n-1}{n} \quad & \iff \quad 
  n^2 > (n-1)(n+1) \quad  \\
  & \iff \quad n^2 > n^2 - 1 \\
  & \iff \quad 0 >  - 1
  \end{align*}



- The sequence below is decreasing
$$
a_n = \frac1n \,.
$$


  > We have
  $$
  a_n = \frac1n > \frac{1}{n+1} = a_{n+1} \,.
  $$


:::


The main result about monotone sequences is the Monotone Convergence
Theorem.


::: Theorem
### Monotone Convergence Theorem  {#theorem-monotone-convergence}

Let $(a_n)$ be a sequence in $\R$. Suppose that $(a_n)$ is bounded and
monotone. Then $(a_n)$ converges.

:::


::: Proof

Assume $(a_n)$ is bounded and monotone. Since $(a_n)$ is bounded, the set 
$$
A:=\{ a_n \divider n \in \N \}  \subseteq \R 
$$
is bounded below and above. By the Axiom of Completeness of $\R$ there exist $i,s \in \R$ such that
$$
i = \inf A \,, \quad s = \sup A \,.
$$

We have two cases:

1. $(a_n)$ is increasing: We are going to prove that
$$
\lim_{n \to \infty} a_n = s \,.
$$
Equivalently, we need to prove that
$$
\forall \, \e>0 \,, \, \exists \, N \in \N \st \forall \, n \geq N \,, \,\,
|a_n - s| < \e \,. 
$${#eq-monotone-conv-proof}
Let $\e > 0$. Since $s$ is the smallest upper bound for $A$, this means
$$
s - \e
$$
is not an upper bound. Therefore there exists $N \in \N$ such that 
$$
s - \e < a_N \,.
$${#eq-monotone-convergence-proof-1}
Let $n \geq N$. Since $a_n$ is increasing, we have
$$
a_N \leq a_n \,, \quad \forall \, n \geq N \,.
$${#eq-monotone-convergence-proof-2}
Moreover $s$ is the supremum of $A$, so that
$$
a_n \leq s < s + \e \,, \quad \forall \, n \in \N \,.
$${#eq-monotone-convergence-proof-3}
Putting together estimates (@eq-monotone-convergence-proof-1)-(@eq-monotone-convergence-proof-2)-(@eq-monotone-convergence-proof-3)
we get
$$
s - \e < a_N \leq a_n \leq s < s + \e \,, \quad \forall \, n \geq N \,.
$$
The above implies 
$$
s - \e < a_n < s + \e \,, \quad \forall \, n \geq N \,,
$$
which is equivalent to (@eq-monotone-conv-proof).




2. $(a_n)$ is decreasing: With a similar proof, one can show that
$$
\lim_{n \to \infty} a_n = i \,.
$$
This is left as an exercise.


:::








### Example: Euler's Number


As an application of the Monotone Convergence Theorem we can give
a formal definition for the Euler's Number
$$
e = 2.71828182845904523536 \dots
$$


::: {.Theorem #theorem-euler-number}

Consider the sequence
$$
a_n = \left(  1 + \frac{1}{n}  \right)^n  \,.
$$

We have that:

1. $(a_n)$ is monotone increasing,
2. $(a_n)$ is bounded.

In particular $(a_n)$ is convergent.

:::



::: Proof


*Part 1.* We prove that $(a_n)$ is increasing
$$
a_{n} \geq a_{n-1} \,, \quad \forall \, n \in \N \,,
$$
which by definition is equivalent to
$$
\left(  1 + \frac{1}{n}  \right)^n \geq 
\left(  1 + \frac{1}{n - 1}  \right)^{n-1} \,, \quad \forall \, n \in \N \,.
$$
Summing the fractions we get
$$
\left(  \frac{n+1}{n}  \right)^n \geq 
\left(  \frac{n}{n-1}  \right)^{n-1} \,.  
$$
Multiplying by $((n-1)/n)^n$ we obtain
$$
\left(  \frac{n-1}{n}  \right)^n  \left(  \frac{n+1}{n}  \right)^n  \geq 
 \frac{n-1}{n}  \,,
$$
which simplifies to
$$
\left(  1 - \frac{1}{n^2}  \right)^n \geq 1 - \frac1n \,, \quad  \forall \, n \in \N \,.
$${#eq-proof-euler-1}
Therefore $(a_n)$ is increasing if and only if (@eq-proof-euler-1) holds.
Recall Bernoulli's inequality from Lemma \ref{lemma-bernoulli}: For
$x \in \R$, $x>-1$, it holds
$$
(1 + x )^n  \geq 1 + nx  \,, \quad \forall \, n \in \N \,.
$$
Appliying Bernoulli's inequality with 
$$
x = -\frac{1}{n^2}
$$
yields
$$
\left(  1 - \frac{1}{n^2}  \right)^n  \geq 1 + n \left( -\frac{1}{n^2} \right) = 1 - \frac{1}{n} \,,
$$
which is exactly (@eq-proof-euler-1). Then $(a_n)$ is increasing.



*Part 2*. We have to prove that $(a_n)$ is bounded, that is, that there
exists $M > 0$ such that
$$
|a_n| \leq M \,, \quad \forall \, n \in \N \,.
$$
To this end, introduce the sequence $(b_n)$ by setting
$$
b_n := \left(   1  + \frac1n \right)^{n+1} \,.
$$
The sequence $(b_n)$ is decreasing.

> To prove $(b_n)$ is decreasing, we need to show that 
$$
b_{n-1} \geq b_n \,, \quad \forall \, n \in \N \,. 
$$
By definition of $b_n$, the above reads
$$
\left(   1  + \frac{1}{n-1} \right)^{n} \geq
\left(   1  + \frac{1}{n} \right)^{n+1} \,, \quad \forall \, n \in \N \,.
$$
Summing the terms inside the brackets, the above is equivalent to
$$
\left(   \frac{n}{n-1} \right)^{n} \geq
\left(   \frac{n+1}{n} \right)^{n} \left(   \frac{n+1}{n} \right) \,.
$$
Multiplying  by $(n/(n+1))^n$ we get
$$
\left(  \frac{n^2}{n^2 - 1} \right)^{n} \geq  \left(   \frac{n+1}{n} \right) \,.
$$
The above is equivalent to
$$
\left( 1 +  \frac{1}{n^2 - 1} \right)^{n} \geq  \left(  1 + \frac{1}{n} \right) \,.
$${#eq-proof-euler-3}
Therefore $(b_n)$ is decreasing if and only if (@eq-proof-euler-3) holds for all $n \in \N$.
By choosing 
$$
x = \frac{1}{n^2 - 1} 
$$
in Bernoulli's inequality, we obtain
\begin{align*}
\left( 1 +  \frac{1}{n^2 - 1} \right)^{n} & \geq 1 + n \left(  \frac{1}{n^2 - 1}   \right) \\
& = 1 + \frac{n}{n^2 - 1} \\
& \geq 1 + \frac1n \,,
\end{align*}
where in the last inequality we used that 
$$
 \frac{n}{n^2 - 1} > \frac1n \,,
$$
which holds, being equivalent to $n^2 > n^2 - 1$. We have therefore proven
(@eq-proof-euler-3), and hence $(b_n)$ is decreasing.


We now observe that
For all $n \in \N$
\begin{align*}
b_n & = \left(   1  + \frac1n \right)^{n+1} \\
    & = \left(   1  + \frac1n \right)^n \left(   1  + \frac1n \right) \\ 
    & = a_n \left(   1  + \frac1n \right) \\
    & > a_n \,.
\end{align*}
Since $(a_n)$ is increasing and $(b_n)$ is decreasing, in particular
$$
a_n \geq a_1 \,, \quad b_n \leq b_1 \,.
$$
Therefore
$$
a_1 \leq a_n < b_n \leq b_1 \,, \quad \forall \, n \in \N \,.
$$
We compute
$$
a_1 = 2 \,, \quad b_1 = 4 \,,
$$
from which we get 
$$
2 \leq a_n \leq 4 \,, \quad \forall \, n \in \N \,.
$$
Therefore 
$$
|a_n| \leq 4 \,, \quad \forall \, n \in \N \,,
$$
showing that $(a_n)$ is bounded.


*Part 3.* The sequence $(a_n)$ is increasing and bounded above. Therefore $(a_n)$ is convergent by the Monotone Convergence Theorem \ref{theorem-monotone-convergence}.

:::




Thanks to Theorem \ref{theorem-euler-number} we can define the Euler's Number $e$.


::: Definition
### Euler's Number

The Euler's number is defined as
$$
e := \lim_{n \to \infty } \, \left(  1 + \frac{1}{n}  \right)^n \,.
$$

:::


Setting $n=1000$ in the formula for $(a_n)$, we get an approximation of $e$:
$$
e \approx a_{1000} = 2.7169 \,.
$$






## Some important limits



In this section we investigate limits of some sequences to which 
the Limit Tests do not apply.


::: Theorem

Let $x \in \R$, with $x > 0$. Then
$$
\lim_{n \to \infty} \sqrt[n]{x} = 1 \,.
$$

:::


::: Proof

*Step 1.* Assume $x \geq 1$. In this case
$$
\sqrt[n]{x} \geq 1 \,.
$$
Define 
$$
b_n := \sqrt[n]{x} - 1 \,,
$$
so that $b_n \geq 0$. By Bernoulli's Inequality we have
$$
x = (1 + b_n)^n \geq 1 + n b_n \,.
$$
Therefore 
$$
0 \leq b_n \leq \frac{x-1}{n} \,.
$$
Since 
$$
\frac{x-1}{n} \longrightarrow 0 \,,
$$
by the Squeeze Theorem we infer $b_n \to 0$, and hence 
$$
\sqrt[n]{x} = 1 + b_n \longrightarrow 1 + 0 = 1\,, 
$$
by the Algebra of Limits.

*Step 2.* Assume $0< x < 1$. In this case
$$
\frac{1}{x} > 1 \,.
$$
Therefore
$$
\lim_{n \to \infty} \, \sqrt[n]{  1/x  } = 1  \,.
$$
by Step 1. Therefore
$$
\sqrt[n]{x} = \frac{1}{\sqrt[n]{  1/x  }} \longrightarrow \frac{1}{1} = 1\,,
$$
by the Algebra of Limits.

:::



::: {.Theorem   #theorem-important-limit-1}

Let $(a_n)$ be a sequence such that $a_n \to 0$. Then
$$
\sin(a_n) \to 0 \,, \quad 
\cos(a_n) \to 1 \,.
$$

:::

::: Proof

Assume that $a_n \to 0$ and set
$$
\e := \frac{\pi}{2} \,.
$$
By the convergence $a_m \to 0$ there exists $N \in \N$ such that
$$
|a_n| < \e = \frac{\pi}{2} \, \quad \forall \, n \geq N \,.
$${#eq-limiti-notevoli-1}


*Step 1*. We prove that 
$$
\sin(a_n) \to 0 \,.
$$
By elementary trigonometry we have
$$
0 \leq |\sin (x)| = \sin |x| \leq |x| \,, \quad \forall  \, x \in \left[
-\frac{\pi}{2}, \frac{\pi}{2} \right] \,.
$$
Therefore, since (@eq-limiti-notevoli-1) holds, we can substitute $x=a_n$ in the above inequality to get
$$
0 \leq |\sin (a_n)|  \leq |a_n| \,, \quad \forall \, n \geq \N \,.
$$
Since $a_n \to 0$, we also have $|a_n|\to 0$. Therefore 
$|\sin (a_n)| \to 0$ by the Squeeze Theorem. This immediately implies 
$\sin(a_n) \to 0$.

*Step 2*. We prove that 
$$
\cos(a_n) \to 1 \,.
$$
Inverting the relation
$$
\cos^2(x) + \sin^2 (x) = 1 \,,
$$
we obtain
$$
\cos(x) = \pm \sqrt{ 1 - \sin^2 (x) } \,.
$$
We have that $\cos(x) \geq 0$ for $-\pi/2 \leq x \leq \pi/2$. Thus
$$
\cos(x) = \sqrt{ 1 - \sin^2 (x) } \,, \quad \forall \, x \in 
\left[ -\frac{\pi}{2}, \frac{\pi}{2} \right] \,.
$$
Since (@eq-limiti-notevoli-1) holds, we can set $x=a_n$ in the above inequality and obtain
$$
\cos(a_n) = \sqrt{ 1 - \sin^2 (a_n) } \,, \quad \forall \, n \geq N \,. 
$$
By Step 1 we know that $\sin(a_n) \to 0$. Therefore, by the Algebra of Limits,
$$
 1 - \sin^2 (a_n) \longrightarrow 1 - 0 \cdot 0 = 1 \,.
$$
Using Theorem \ref{theorem-square-root-limit} we have
$$
\cos(a_n) = \sqrt{1 - \sin^2 (a_n)} \longrightarrow \sqrt{1} = 1 \,,
$$
concluding the proof.


:::



::: {.Theorem  #theorem-important-limit-2}

Suppose $(a_n)$ is such that $a_n \to 0$ and 
$$
a_n \neq 0 \,, \quad \forall \, n \in \N \, .
$$
Then
$$
\lim_{n \to \infty} \frac{\sin(a_n)}{a_n} = 1 \,.
$$

:::


::: Proof

The following elementary trigonometric inequality holds:
$$
\sin (x) < x < \tan (x) \,, \quad \forall \, x \in \left[0 ,\frac{\pi}{2} \right]  \,.
$$
Note that $\sin x >0$ for $0 < x < \pi/2$. Therefore we can divide the
above inequality by $\sin(x)$ and take the reciprocals to get
$$
\cos(x) < \frac{\sin (x)}{x} < 1 \,, \quad \forall \, x \in \Big( 0 ,\frac{\pi}{2} \Big] \,.
$$
If $-\pi/2<x<0$, we can apply the above inequality to $-x$ to obtain
$$
\cos(-x) < \frac{\sin(-x)}{-x} < 1  \,.
$$
Recalling that $\cos(-x) = \cos(x)$ and $\sin(-x)=-\sin(x)$, we get
$$
\cos(x) < \frac{\sin(x)}{x} < 1  \,, \quad \forall \, x \in \Big( -\frac{\pi}{2}, 0 \Big] \,.
$$
Thus
$$
\cos(x) < \frac{\sin(x)}{x} < 1  \,, \quad \forall  \, x \in \left[-\frac{\pi}{2}, \frac{\pi}{2} \right] \smallsetminus \{0\} \,.
$${#eq-limiti-notevoli-3}
Let 
$$
\e := \frac{\pi}{2} \,.
$$
Since $a_n \to 0$, there exists $N \in \N$ such that
$$
|a_n| < \e = \frac{\pi}{2} \,, \quad \forall \, n \geq N \,.
$$
Since $a_n \neq 0$ by assumption, the above shows that
$$
a_n \in \Big[ -\frac{\pi}{2}, \frac{\pi}{2}  \Big] \smallsetminus \{0\} \,, 
\quad \forall \, n \geq \N \,.
$$
Therefore we can substitute $x=a_n$ into (@eq-limiti-notevoli-3) to get
$$
\cos(a_n) < \frac{\sin(a_n)}{a_n} < 1  \,, \quad \forall  \, n \geq N \,.
$$
We have
$$
\cos(a_n) \to 1
$$ 
by Theorem \ref{theorem-important-limit-1}. By the Squeeze Theorem we conclude that
$$
\lim_{n \to \infty} \frac{\sin(a_n)}{a_n} = 1 \,.
$$

:::



::: Warning

You might be tempted to apply L'Hôpital's rule (which we did not cover in these Lecture Notes) to compute 
$$
\lim_{x \to 0} \frac{\sin(x)}{x}  \,.
$$
This would yield the correct limit
$$
\lim_{x \to 0} \frac{\sin(x)}{x} =
\lim_{x \to 0} \frac{(\sin(x))'}{(x)'} = 
\lim_{x \to 0} \cos(x) = 1  \,.
$$
However this is a circular argument, since the derivative of 
$\sin(x)$ at $x=0$ is defined as the limit
$$
\lim_{x \to 0} \frac{\sin(x)}{x} \,.
$$

:::




::: {.Theorem  #theorem-important-limit-3}

Suppose $(a_n)$ is such that $a_n \to 0$ and 
$$
a_n \neq 0 \,, \quad \forall \, n \in \N \, .
$$
Then
$$
\lim_{n \to \infty} \frac{1 - \cos(a_n)}{(a_n)^2} = \frac{1}{2} \,, \quad 
\lim_{n \to \infty} \frac{1 - \cos(a_n)}{a_n} = 0  \, .
$$

:::


::: Proof

*Step 1.*  By Theorem \ref{theorem-important-limit-1} and Theorem \ref{theorem-important-limit-2}, we have
$$
\cos(a_n) \to 1 \,, \quad \frac{\sin(a_n)}{a_n} \to 1 \,.
$$
Therefore
\begin{align*}
\frac{1 - \cos(a_n)}{(a_n)^2} & = 
\frac{1 - \cos(a_n)}{(a_n)^2} \, \frac{1 + \cos(a_n)}{1 + \cos(a_n)} \\
& = \frac{1 - \cos^2(a_n)}{(a_n)^2} \,  \frac{1}{1 + \cos(a_n)} \\
& = \left( \frac{\sin(a_n)}{a_n}   \right)^2 \, \frac{1}{1 + \cos(a_n)} \longrightarrow 1 \cdot \frac{1}{1 + 1} = \frac12 \,,
\end{align*}
where in the last line we use the Algebra of Limits. 

*Step 2.* We have
$$
\frac{1 - \cos(a_n)}{a_n} =  a_n \cdot \frac{1 - \cos(a_n)}{(a_n)^2} \longrightarrow 0 \cdot \frac{1}{2} = 0 \,, 
$$
using Step 1 and the Algebra of Limits.



:::





::: Example



- We have
$$
\lim_{n \to \infty} \, n  \sin \left(  \frac{1}{n} \right)  = 1 \,.
$${#eq-notable-limits-2}
This is because
$$
n  \sin \left(  \frac{1}{n} \right) = \frac{ \sin \left(  \dfrac{1}{n} \right) }{ \dfrac{1}{n} } \longrightarrow 1 \,,
$$
by Theorem \ref{theorem-important-limit-2} with $a_n = 1/n$.


- We have
$$
\lim_{n \to \infty} \, n^2 \left(  1 - \cos \left(  \dfrac{1}{n} \right)  \right) = \frac12 \,.
$${#eq-notable-limits-1}
Indeed, 
$$
n^2 \left(  1 - \cos \left(  \frac{1}{n} \right)\right) = \dfrac{1 - \cos \left(  \dfrac{1}{n} \right)}{\dfrac{1}{n^2}} \longrightarrow \frac12 \,,
$$
by applying Theorem \ref{theorem-important-limit-3} with $a_n = 1/n$.


- We have
$$
\lim_{n \to \infty} \, \frac{n  \left( 1- \cos \left(  \dfrac{1}{n} \right) \right) }{ \sin \left( \dfrac{1}{n} \right) } = \frac12 \,.
$$
Indeed, using (@eq-notable-limits-1)-(@eq-notable-limits-2) and the Algebra of Limits
$$
 \frac{n  \left( 1- \cos \left(  \dfrac{1}{n} \right) \right) }{ \sin \left( \dfrac{1}{n} \right) } =
  \frac{n^2  \left( 1- \cos \left(  \dfrac{1}{n} \right) \right) }{ n \sin \left( \dfrac{1}{n} \right) } \longrightarrow \frac{1/2}{1} = \frac12 \,.
$$


- We have
$$
\lim_{n \to \infty} \, n \cos \left( \frac{2}{n}  \right) \sin \left( \frac{2}{n}  \right) = 2 \,.
$$
This is because 
$$
\cos \left( \frac{2}{n}  \right) \longrightarrow 1 \,,
$$
by Theorem \ref{theorem-important-limit-1} applied with $a_n = 2/n$. Moreover
$$
\frac{\sin \left( \dfrac{2}{n}  \right)}{\dfrac{2}{n}} \longrightarrow 1 \,,
$$
by Theorem \ref{theorem-important-limit-2} applied with $a_n = 2/n$. Therefore
$$
n \cos \left( \frac{2}{n}  \right) \sin \left( \frac{2}{n}  \right) = 
2 \cdot \cos \left( \frac{2}{n}  \right) \cdot \frac{\sin \left( \dfrac{2}{n}  \right)}{\dfrac{2}{n}} 
\longrightarrow 2 \cdot 1 \cdot 1 = 2 
$$
where we used the Algebra of Limits.



-  We have
$$
\lim_{n \to \infty} \, \frac{n^2+1}{n+1} \sin \left(  \dfrac{1}{n} \right)  = 1 \,.
$$
To prove it, note that
$$
\frac{n^2+1}{n+1} \sin \left(  \dfrac{1}{n} \right) = \left( \frac{1+\dfrac{1}{n^2}}{1+ \dfrac{1}{n}} \right) \cdot \left( n \sin \left(  \dfrac{1}{n} \right) \right) \longrightarrow \frac{1 + 0}{1 + 0} \cdot 1 = 1\,,
$$
where we used (@eq-notable-limits-2) and the Algebra of Limits.


:::




::: {.content-hidden}



Use abbot, marcellini, and analisi sapienza note. For next year remove integral test and add cauchy condensation test.


## Divergence to infinity

Do this from abbott or marcellini. For the moment we have only done
divergent as non-convergent. Would need definition of Divergence to $\pm \infty$. Vedi anche forme indeterminate a pagina 96 Marcellini.





## Recurrence relations

Marcellini Page 110



## Example: Heron's Method


The first explicit algorithm for approximating 
$$
\sqrt{x}
$$ 
for $x > 0$ is known as **Heron's method**, after the first-century Greek mathematician [Heron of Alexandria](https://en.wikipedia.org/wiki/Hero_of_Alexandria) who described the method in his AD 60 work Metrica, see reference to
[Wikipedia page](https://en.wikipedia.org/wiki/Methods_of_computing_square_roots#Babylonian_method).

Let us see what is the idea of the algorithm:

- Suppose that $a_1$ is an approximation of $\sqrt{x}$ from above, that is,
$$
 \sqrt{x} < a_1 \,.
$$ {#eq-heron}
- Multiplying (@eq-heron) by $\sqrt{x}/a_1$ we obtain
$$
\frac{x}{a_1} < \sqrt{x} \,,
$${#eq-heron-1}
obtaining an approximation of $\sqrt{x}$ from below.
- Therefore, putting together the above inequalities,
$$
\frac{x}{a_1} < \sqrt{x} < a_1 
$$ {#eq-heron-2}
- If we take the average of the points $x/a_1$ and $a_1$, it is reasonable to think that we find a better approximation of $\sqrt{x}$. Thus our next approximation is
$$
a_2 := \frac{1}{2} \left( a_1 + \frac{x}{a_1} \right) \,,
$$
see figure below.


![Heron's Algorithm for approximating $\sqrt{x}$](/images/heron.png){width=70%}


Iterating, we define by recurrence the sequence 
$$
a_{n+1} := \frac12  \left( a_n + \frac{x}{a_n} \right)
$$
for all $n \in \N$, where the initial guess $a_1$ has to satisfy (@eq-heron). The aim of the section is to show that
$$
\lim_{n \to \infty } \ a_n = \sqrt{x} \,.
$${#eq-heron-convergence}
We start by showing that (@eq-heron-2) holds for all $n \in \N$.

::: {.Proposition  #proposition-heron}
We have
$$
\frac{x}{a_n} < \sqrt{x} < a_n 
$${#eq-heron-3}
for all $n \in \N$.
:::


::: Proof
We prove it by induction:

1. By (@eq-heron) and (@eq-heron-1) we know that (@eq-heron-3) holds for $n=1$. 

2. Suppose now that (@eq-heron-3) holds for $n$. Then
\begin{align}
a_{n+1} - \sqrt{x} & = \frac12  \left( a_n + \frac{x}{a_n} \right) - \sqrt{x} \\
& = \frac{1}{2 a_n} ( a_n^2 + x - 2 a_n \sqrt{x} ) \\
& = \frac{1}{2 a_n} ( a_n - \sqrt{x} )^2 > 0 \,,
\end{align}
since we are assuming that $a_n > \sqrt{x}$. Therefore
$$
\sqrt{x} < a_{n+1} \,.
$${#eq-heron-proof-1}
Multiplying the above by $\sqrt{x}/a_{n+1}$ we get
$$
\frac{x}{a_{n+1}} < \sqrt{x} \,.
$${#eq-heron-proof-2}
Inequalities (@eq-heron-proof-1) and (@eq-heron-proof-2) show that (@eq-heron-3) holds for $n+1$.

Therefore we conclude (@eq-heron-3) by the Principle of Induction.
:::


We are now ready to prove error estimates, that is, estimating how far away $a_n$ is from $\sqrt{x}$. 


::: Proposition
### Error estimate {#proposition-heron-error}
For all $n \in \N$ we have
$$
a_{n+1} - \sqrt{x} < \frac12 (a_{n} - \sqrt{x}) \,.
$${#eq-heron-half}
:::


::: Proof
By Proposition \ref{proposition-heron} we know that 
$$
\frac{x}{a_n} < \sqrt{x}
$$
for all $n \in \N$. Therefore
\begin{align}
a_{n+1} & = \frac12 \left(  a_n +  \frac{x}{a_n}   \right) \\
        & < \frac12 \left(  a_n +  \sqrt{x}   \right) \,.
\end{align}
Subtracting $\sqrt{x}$ from both members in the above inequality we get the thesis.
:::


Inequality (@eq-heron-half) is saying that the error halves at each step. Therefore we can prove that after $n$ steps the error is exponentially lower, as detailed in the following proposition.


::: {.Proposition #proposition-heron-error-exp}
For all $n \in \N$ we have
$$
a_{n+1} - \sqrt{x} < \frac{1}{2^n} (a_1 - \sqrt{x})
$$ {#eq-heron-error}
:::



::: Proof
We prove (@eq-heron-error) by induction:

1. For $n=1$ we have that (@eq-heron-error) is satisfied, since it coincides with (@eq-heron-half) for $n=1$.
2. Suppose that (@eq-heron-error) holds for $n$. By (@eq-heron-half) with $n$ replaced by $n+1$ we have
\begin{align}
a_{n+2} - \sqrt{x} & < \frac12 (a_{n+1} - \sqrt{x}) \\
& < \frac12 \,\cdot \, \frac{1}{2^n} (a_{1} - \sqrt{x}) \\
& = \frac{1}{2^{n+1}} (a_{1} - \sqrt{x})
\end{align}
where in the second inequality we used the induction hypothesis (@eq-heron-error). Hence (@eq-heron-error) holds for $n+1$.

By invoking the Induction Principle we conclude the proof.
:::

Let us comment estimate (@eq-heron-error). Denote the error at step $n$ by
$$
e_n := a_n - \sqrt{x}\,.
$$
The initial error $e_1$ depends on how far the initial guess is from $\sqrt{x}$. The estimate in (@eq-heron-error) is telling us that $e_n$ is a fraction of $e_1$, and actually
$$
\lim_{n \to \infty} \ e_n = 0
$$
exponentially fast. From this fact we are finally able to prove (@eq-heron-convergence).

::: Theorem
### Convergence of Heron's Algorithm
We have that 
$$
\lim_{n \to \infty} \ a_n = \sqrt{x} \,.
$$
:::

::: Proof
By Proposition \ref{proposition-heron-error-exp} we have that
$$
a_{n+1} - \sqrt{x} < \frac{1}{2^n} (a_1 - \sqrt{x})
$$
Moreover Proposition \ref{proposition-heron} tells us that
$$
\sqrt{x} < a_{n+1} \,.
$$
Putting together the two inequalities above we infer
$$
\sqrt{x} < a_{n+1} < \sqrt{x} + \frac{1}{2^n} (a_1 - \sqrt{x}) \,.
$${#eq-heron-final}
Now note that
$$
\lim_{n \to \infty} \ \frac{1}{2^n} =
\lim_{n \to \infty} \ \left( \frac{1}{2} \right)^n = 0 \,.
$$
Therefore the RHS of (@eq-heron-final) converges to $\sqrt{x}$ as $n \to \infty$. Applying the Squeeze Theorem to (@eq-heron-final) we conclude that $a_n \to \sqrt{x}$ as $n \to \infty$.
:::





### Coding the Algorithm

Heron's Algorithm can be easily coded in Python. For example, see the function below:

```python
# x is the number for which to compute sqrt(x)
# guess is the point a_1
# a_1 must be strictly larger than sqrt(x)
# n is the number of iterations
# the function returns a_{n+1}

def herons_algorithm(x, guess, n):
    for i in range(n):
        guess = (guess + x / guess) / 2.0
    return guess
```

For example let us use the Algorithm to compute $\sqrt{2}$ after $3$ iterations. For initial guess we take $a_1 = 2$. 

```python
# Calculate sqrt(2) with 3 iterations and guess 2
sqrt_2 = herons_algorithm(2, 2, 3)

print(f"The sqrt(2) is approximately {sqrt_2}")
```

```{python}
#| echo: false 

def herons_algorithm(x, guess, n):
    for i in range(n):
        guess = (guess + x / guess) / 2.0
    return guess

# Calculate sqrt(2) with 3 iterations and guess 2
sqrt_2 = herons_algorithm(2, 2, 3)

print(f"The sqrt(2) is approximately {sqrt_2}")
```

That is a pretty good approximation in just $3$ iterations!





## Fibonacci Sequence




:::